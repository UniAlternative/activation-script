import t from"node:process";import e from"node:path";import i from"node:fs";import s from"readline";import r from"events";import n from"child_process";import o from"path";import h from"fs";import a from"process";import{execSync as l}from"node:child_process";function u(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var c,d,p,m,f,g,v,b,y,w,_,x,O,S,C,$,A,M,k,E,T,P,j,I,D,H,V,F,R,N,L,Y,q,U,W,G,B,J,z,Z,K,Q,X,tt,et,it,st,rt,nt,ot,ht,at,lt,ut,ct,dt,pt,mt,ft,gt,vt,bt,yt,wt,_t,xt,Ot,St={};function Ct(){if(d)return c;d=1;const{FORCE_COLOR:t,NODE_DISABLE_COLORS:e,TERM:i}=process.env,s={enabled:!e&&"dumb"!==i&&"0"!==t,reset:n(0,0),bold:n(1,22),dim:n(2,22),italic:n(3,23),underline:n(4,24),inverse:n(7,27),hidden:n(8,28),strikethrough:n(9,29),black:n(30,39),red:n(31,39),green:n(32,39),yellow:n(33,39),blue:n(34,39),magenta:n(35,39),cyan:n(36,39),white:n(37,39),gray:n(90,39),grey:n(90,39),bgBlack:n(40,49),bgRed:n(41,49),bgGreen:n(42,49),bgYellow:n(43,49),bgBlue:n(44,49),bgMagenta:n(45,49),bgCyan:n(46,49),bgWhite:n(47,49)};function r(t,e){let i,s=0,r="",n="";for(;s<t.length;s++)i=t[s],r+=i.open,n+=i.close,e.includes(i.close)&&(e=e.replace(i.rgx,i.close+i.open));return r+e+n}function n(t,e){let i={open:`[${t}m`,close:`[${e}m`,rgx:new RegExp(`\\x1b\\[${e}m`,"g")};return function(e){return void 0!==this&&void 0!==this.has?(this.has.includes(t)||(this.has.push(t),this.keys.push(i)),void 0===e?this:s.enabled?r(this.keys,e+""):e+""):void 0===e?function(t,e){let i={has:t,keys:e};return i.reset=s.reset.bind(i),i.bold=s.bold.bind(i),i.dim=s.dim.bind(i),i.italic=s.italic.bind(i),i.underline=s.underline.bind(i),i.inverse=s.inverse.bind(i),i.hidden=s.hidden.bind(i),i.strikethrough=s.strikethrough.bind(i),i.black=s.black.bind(i),i.red=s.red.bind(i),i.green=s.green.bind(i),i.yellow=s.yellow.bind(i),i.blue=s.blue.bind(i),i.magenta=s.magenta.bind(i),i.cyan=s.cyan.bind(i),i.white=s.white.bind(i),i.gray=s.gray.bind(i),i.grey=s.grey.bind(i),i.bgBlack=s.bgBlack.bind(i),i.bgRed=s.bgRed.bind(i),i.bgGreen=s.bgGreen.bind(i),i.bgYellow=s.bgYellow.bind(i),i.bgBlue=s.bgBlue.bind(i),i.bgMagenta=s.bgMagenta.bind(i),i.bgCyan=s.bgCyan.bind(i),i.bgWhite=s.bgWhite.bind(i),i}([t],[i]):s.enabled?r([i],e+""):e+""}}return c=s}function $t(){return g?f:(g=1,f=t=>{const e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PRZcf-ntqry=><~]))"].join("|"),i=new RegExp(e,"g");return"string"==typeof t?t.replace(i,""):t})}function At(){if(b)return v;b=1;const t="[",e={to:(e,i)=>i?`${t}${i+1};${e+1}H`:`${t}${e+1}G`,move(e,i){let s="";return e<0?s+=`${t}${-e}D`:e>0&&(s+=`${t}${e}C`),i<0?s+=`${t}${-i}A`:i>0&&(s+=`${t}${i}B`),s},up:(e=1)=>`${t}${e}A`,down:(e=1)=>`${t}${e}B`,forward:(e=1)=>`${t}${e}C`,backward:(e=1)=>`${t}${e}D`,nextLine:(e=1)=>`${t}E`.repeat(e),prevLine:(e=1)=>`${t}F`.repeat(e),left:`${t}G`,hide:`${t}?25l`,show:`${t}?25h`,save:"7",restore:"8"},i={screen:`${t}2J`,up:(e=1)=>`${t}1J`.repeat(e),down:(e=1)=>`${t}J`.repeat(e),line:`${t}2K`,lineEnd:`${t}K`,lineStart:`${t}1K`,lines(t){let i="";for(let s=0;s<t;s++)i+=this.line+(s<t-1?e.up():"");return t&&(i+=e.left),i}};return v={cursor:e,scroll:{up:(e=1)=>`${t}S`.repeat(e),down:(e=1)=>`${t}T`.repeat(e)},erase:i,beep:""}}function Mt(){if(w)return y;function t(t,i){var s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!s){if(Array.isArray(t)||(s=function(t,i){if(!t)return;if("string"==typeof t)return e(t,i);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(t);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return e(t,i)}(t))||i&&t&&"number"==typeof t.length){s&&(t=s);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,h=!0,a=!1;return{s:function(){s=s.call(t)},n:function(){var t=s.next();return h=t.done,t},e:function(t){a=!0,o=t},f:function(){try{h||null==s.return||s.return()}finally{if(a)throw o}}}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,s=new Array(e);i<e;i++)s[i]=t[i];return s}w=1;const i=$t(),s=At(),r=s.erase,n=s.cursor;return y=function(e,s){if(!s)return r.line+n.to(0);let o=0;var h,a=t(e.split(/\r?\n/));try{for(a.s();!(h=a.n()).done;){let t=h.value;o+=1+Math.floor(Math.max([...i(t)].length-1,0)/s)}}catch(t){a.e(t)}finally{a.f()}return r.lines(o)},y}function kt(){if(x)return _;x=1;const t={arrowUp:"↑",arrowDown:"↓",arrowLeft:"←",arrowRight:"→",radioOn:"◉",radioOff:"◯",tick:"✔",cross:"✖",ellipsis:"…",pointerSmall:"›",line:"─",pointer:"❯"},e={arrowUp:t.arrowUp,arrowDown:t.arrowDown,arrowLeft:t.arrowLeft,arrowRight:t.arrowRight,radioOn:"(*)",radioOff:"( )",tick:"√",cross:"×",ellipsis:"...",pointerSmall:"»",line:"─",pointer:">"},i="win32"===process.platform?e:t;return _=i}function Et(){if(S)return O;S=1;const t=Ct(),e=kt(),i=Object.freeze({password:{scale:1,render:t=>"*".repeat(t.length)},emoji:{scale:2,render:t=>"😃".repeat(t.length)},invisible:{scale:0,render:t=>""},default:{scale:1,render:t=>`${t}`}}),s=Object.freeze({aborted:t.red(e.cross),done:t.green(e.tick),exited:t.yellow(e.cross),default:t.cyan("?")});return O={styles:i,render:t=>i[t]||i.default,symbols:s,symbol:(t,e,i)=>e?s.aborted:i?s.exited:t?s.done:s.default,delimiter:i=>t.gray(i?e.ellipsis:e.pointerSmall),item:(i,s)=>t.gray(i?s?e.pointerSmall:"+":e.line)}}function Tt(){if($)return C;$=1;const t=$t();return C=function(e,i){let s=String(t(e)||"").split(/\r?\n/);return i?s.map((t=>Math.ceil(t.length/i))).reduce(((t,e)=>t+e)):s.length},C}function Pt(){return P?T:(P=1,T={action:m?p:(m=1,p=(t,e)=>{if(!t.meta||"escape"===t.name){if(t.ctrl){if("a"===t.name)return"first";if("c"===t.name)return"abort";if("d"===t.name)return"abort";if("e"===t.name)return"last";if("g"===t.name)return"reset"}if(e){if("j"===t.name)return"down";if("k"===t.name)return"up"}return"return"===t.name||"enter"===t.name?"submit":"backspace"===t.name?"delete":"delete"===t.name?"deleteForward":"abort"===t.name?"abort":"escape"===t.name?"exit":"tab"===t.name?"next":"pagedown"===t.name?"nextPage":"pageup"===t.name?"prevPage":"home"===t.name?"home":"end"===t.name?"end":"up"===t.name?"up":"down"===t.name?"down":"right"===t.name?"right":"left"===t.name&&"left"}}),clear:Mt(),style:Et(),strip:$t(),figures:kt(),lines:Tt(),wrap:M?A:(M=1,A=(t,e={})=>{const i=Number.isSafeInteger(parseInt(e.margin))?new Array(parseInt(e.margin)).fill(" ").join(""):e.margin||"",s=e.width;return(t||"").split(/\r?\n/g).map((t=>t.split(/\s+/g).reduce(((t,e)=>(e.length+i.length>=s||t[t.length-1].length+e.length+1<s?t[t.length-1]+=` ${e}`:t.push(`${i}${e}`),t)),[i]).join("\n"))).join("\n")}),entriesToDisplay:E?k:(E=1,k=(t,e,i)=>{i=i||e;let s=Math.min(e-i,t-Math.floor(i/2));return s<0&&(s=0),{startIndex:s,endIndex:Math.min(s+i,e)}})})}function jt(){if(I)return j;I=1;const t=s,e=Pt().action,i=r,n=At(),o=n.beep,h=n.cursor,a=Ct();return j=class extends i{constructor(i={}){super(),this.firstRender=!0,this.in=i.stdin||process.stdin,this.out=i.stdout||process.stdout,this.onRender=(i.onRender||(()=>{})).bind(this);const s=t.createInterface({input:this.in,escapeCodeTimeout:50});t.emitKeypressEvents(this.in,s),this.in.isTTY&&this.in.setRawMode(!0);const r=["SelectPrompt","MultiselectPrompt"].indexOf(this.constructor.name)>-1,n=(t,i)=>{let s=e(i,r);!1===s?this._&&this._(t,i):"function"==typeof this[s]?this[s](i):this.bell()};this.close=()=>{this.out.write(h.show),this.in.removeListener("keypress",n),this.in.isTTY&&this.in.setRawMode(!1),s.close(),this.emit(this.aborted?"abort":this.exited?"exit":"submit",this.value),this.closed=!0},this.in.on("keypress",n)}fire(){this.emit("state",{value:this.value,aborted:!!this.aborted,exited:!!this.exited})}bell(){this.out.write(o)}render(){this.onRender(a),this.firstRender&&(this.firstRender=!1)}}}function It(){if(H)return D;function t(t,e,i,s,r,n,o){try{var h=t[n](o),a=h.value}catch(t){return void i(t)}h.done?e(a):Promise.resolve(a).then(s,r)}function e(e){return function(){var i=this,s=arguments;return new Promise((function(r,n){var o=e.apply(i,s);function h(e){t(o,r,n,h,a,"next",e)}function a(e){t(o,r,n,h,a,"throw",e)}h(void 0)}))}}H=1;const i=Ct(),s=jt(),r=At(),n=r.erase,o=r.cursor,h=Pt(),a=h.style,l=h.clear,u=h.lines,c=h.figures;return D=class extends s{constructor(t={}){super(t),this.transform=a.render(t.style),this.scale=this.transform.scale,this.msg=t.message,this.initial=t.initial||"",this.validator=t.validate||(()=>!0),this.value="",this.errorMsg=t.error||"Please Enter A Valid Value",this.cursor=Number(!!this.initial),this.cursorOffset=0,this.clear=l("",this.out.columns),this.render()}set value(t){!t&&this.initial?(this.placeholder=!0,this.rendered=i.gray(this.transform.render(this.initial))):(this.placeholder=!1,this.rendered=this.transform.render(t)),this._value=t,this.fire()}get value(){return this._value}reset(){this.value="",this.cursor=Number(!!this.initial),this.cursorOffset=0,this.fire(),this.render()}exit(){this.abort()}abort(){this.value=this.value||this.initial,this.done=this.aborted=!0,this.error=!1,this.red=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}validate(){var t=this;return e((function*(){let e=yield t.validator(t.value);"string"==typeof e&&(t.errorMsg=e,e=!1),t.error=!e}))()}submit(){var t=this;return e((function*(){if(t.value=t.value||t.initial,t.cursorOffset=0,t.cursor=t.rendered.length,yield t.validate(),t.error)return t.red=!0,t.fire(),void t.render();t.done=!0,t.aborted=!1,t.fire(),t.render(),t.out.write("\n"),t.close()}))()}next(){if(!this.placeholder)return this.bell();this.value=this.initial,this.cursor=this.rendered.length,this.fire(),this.render()}moveCursor(t){this.placeholder||(this.cursor=this.cursor+t,this.cursorOffset+=t)}_(t,e){let i=this.value.slice(0,this.cursor),s=this.value.slice(this.cursor);this.value=`${i}${t}${s}`,this.red=!1,this.cursor=this.placeholder?0:i.length+1,this.render()}delete(){if(this.isCursorAtStart())return this.bell();let t=this.value.slice(0,this.cursor-1),e=this.value.slice(this.cursor);this.value=`${t}${e}`,this.red=!1,this.isCursorAtStart()?this.cursorOffset=0:(this.cursorOffset++,this.moveCursor(-1)),this.render()}deleteForward(){if(this.cursor*this.scale>=this.rendered.length||this.placeholder)return this.bell();let t=this.value.slice(0,this.cursor),e=this.value.slice(this.cursor+1);this.value=`${t}${e}`,this.red=!1,this.isCursorAtEnd()?this.cursorOffset=0:this.cursorOffset++,this.render()}first(){this.cursor=0,this.render()}last(){this.cursor=this.value.length,this.render()}left(){if(this.cursor<=0||this.placeholder)return this.bell();this.moveCursor(-1),this.render()}right(){if(this.cursor*this.scale>=this.rendered.length||this.placeholder)return this.bell();this.moveCursor(1),this.render()}isCursorAtStart(){return 0===this.cursor||this.placeholder&&1===this.cursor}isCursorAtEnd(){return this.cursor===this.rendered.length||this.placeholder&&this.cursor===this.rendered.length+1}render(){this.closed||(this.firstRender||(this.outputError&&this.out.write(o.down(u(this.outputError,this.out.columns)-1)+l(this.outputError,this.out.columns)),this.out.write(l(this.outputText,this.out.columns))),super.render(),this.outputError="",this.outputText=[a.symbol(this.done,this.aborted),i.bold(this.msg),a.delimiter(this.done),this.red?i.red(this.rendered):this.rendered].join(" "),this.error&&(this.outputError+=this.errorMsg.split("\n").reduce(((t,e,s)=>t+`\n${s?" ":c.pointerSmall} ${i.red().italic(e)}`),"")),this.out.write(n.line+o.to(0)+this.outputText+o.save+this.outputError+o.restore+o.move(this.cursorOffset,0)))}}}function Dt(){if(F)return V;F=1;const t=Ct(),e=jt(),i=Pt(),s=i.style,r=i.clear,n=i.figures,o=i.wrap,h=i.entriesToDisplay,a=At().cursor;return V=class extends e{constructor(t={}){super(t),this.msg=t.message,this.hint=t.hint||"- Use arrow-keys. Return to submit.",this.warn=t.warn||"- This option is disabled",this.cursor=t.initial||0,this.choices=t.choices.map(((t,e)=>("string"==typeof t&&(t={title:t,value:e}),{title:t&&(t.title||t.value||t),value:t&&(void 0===t.value?e:t.value),description:t&&t.description,selected:t&&t.selected,disabled:t&&t.disabled}))),this.optionsPerPage=t.optionsPerPage||10,this.value=(this.choices[this.cursor]||{}).value,this.clear=r("",this.out.columns),this.render()}moveCursor(t){this.cursor=t,this.value=this.choices[t].value,this.fire()}reset(){this.moveCursor(0),this.fire(),this.render()}exit(){this.abort()}abort(){this.done=this.aborted=!0,this.fire(),this.render(),this.out.write("\n"),this.close()}submit(){this.selection.disabled?this.bell():(this.done=!0,this.aborted=!1,this.fire(),this.render(),this.out.write("\n"),this.close())}first(){this.moveCursor(0),this.render()}last(){this.moveCursor(this.choices.length-1),this.render()}up(){0===this.cursor?this.moveCursor(this.choices.length-1):this.moveCursor(this.cursor-1),this.render()}down(){this.cursor===this.choices.length-1?this.moveCursor(0):this.moveCursor(this.cursor+1),this.render()}next(){this.moveCursor((this.cursor+1)%this.choices.length),this.render()}_(t,e){if(" "===t)return this.submit()}get selection(){return this.choices[this.cursor]}render(){if(this.closed)return;this.firstRender?this.out.write(a.hide):this.out.write(r(this.outputText,this.out.columns)),super.render();let e=h(this.cursor,this.choices.length,this.optionsPerPage),i=e.startIndex,l=e.endIndex;if(this.outputText=[s.symbol(this.done,this.aborted),t.bold(this.msg),s.delimiter(!1),this.done?this.selection.title:this.selection.disabled?t.yellow(this.warn):t.gray(this.hint)].join(" "),!this.done){this.outputText+="\n";for(let e=i;e<l;e++){let s,r,h="",a=this.choices[e];r=e===i&&i>0?n.arrowUp:e===l-1&&l<this.choices.length?n.arrowDown:" ",a.disabled?(s=this.cursor===e?t.gray().underline(a.title):t.strikethrough().gray(a.title),r=(this.cursor===e?t.bold().gray(n.pointer)+" ":"  ")+r):(s=this.cursor===e?t.cyan().underline(a.title):a.title,r=(this.cursor===e?t.cyan(n.pointer)+" ":"  ")+r,a.description&&this.cursor===e&&(h=` - ${a.description}`,(r.length+s.length+h.length>=this.out.columns||a.description.split(/\r?\n/).length>1)&&(h="\n"+o(a.description,{margin:3,width:this.out.columns})))),this.outputText+=`${r} ${s}${t.gray(h)}\n`}}this.out.write(this.outputText)}}}function Ht(){if(N)return R;N=1;const t=Ct(),e=jt(),i=Pt(),s=i.style,r=i.clear,n=At(),o=n.cursor,h=n.erase;return R=class extends e{constructor(t={}){super(t),this.msg=t.message,this.value=!!t.initial,this.active=t.active||"on",this.inactive=t.inactive||"off",this.initialValue=this.value,this.render()}reset(){this.value=this.initialValue,this.fire(),this.render()}exit(){this.abort()}abort(){this.done=this.aborted=!0,this.fire(),this.render(),this.out.write("\n"),this.close()}submit(){this.done=!0,this.aborted=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}deactivate(){if(!1===this.value)return this.bell();this.value=!1,this.render()}activate(){if(!0===this.value)return this.bell();this.value=!0,this.render()}delete(){this.deactivate()}left(){this.deactivate()}right(){this.activate()}down(){this.deactivate()}up(){this.activate()}next(){this.value=!this.value,this.fire(),this.render()}_(t,e){if(" "===t)this.value=!this.value;else if("1"===t)this.value=!0;else{if("0"!==t)return this.bell();this.value=!1}this.render()}render(){this.closed||(this.firstRender?this.out.write(o.hide):this.out.write(r(this.outputText,this.out.columns)),super.render(),this.outputText=[s.symbol(this.done,this.aborted),t.bold(this.msg),s.delimiter(this.done),this.value?this.inactive:t.cyan().underline(this.inactive),t.gray("/"),this.value?t.cyan().underline(this.active):this.active].join(" "),this.out.write(h.line+o.to(0)+this.outputText))}}}function Vt(){if(Y)return L;Y=1;class t{constructor({token:t,date:e,parts:i,locales:s}){this.token=t,this.date=e||new Date,this.parts=i||[this],this.locales=s||{}}up(){}down(){}next(){const e=this.parts.indexOf(this);return this.parts.find(((i,s)=>s>e&&i instanceof t))}setTo(t){}prev(){let e=[].concat(this.parts).reverse();const i=e.indexOf(this);return e.find(((e,s)=>s>i&&e instanceof t))}toString(){return String(this.date)}}return L=t}function Ft(){if(U)return q;U=1;const t=Vt();return q=class extends t{constructor(t={}){super(t)}up(){this.date.setHours((this.date.getHours()+12)%24)}down(){this.up()}toString(){let t=this.date.getHours()>12?"pm":"am";return/\A/.test(this.token)?t.toUpperCase():t}},q}function Rt(){if(G)return W;G=1;const t=Vt();return W=class extends t{constructor(t={}){super(t)}up(){this.date.setDate(this.date.getDate()+1)}down(){this.date.setDate(this.date.getDate()-1)}setTo(t){this.date.setDate(parseInt(t.substr(-2)))}toString(){let t=this.date.getDate(),e=this.date.getDay();return"DD"===this.token?String(t).padStart(2,"0"):"Do"===this.token?t+(i=t,1==(i%=10)?"st":2===i?"nd":3===i?"rd":"th"):"d"===this.token?e+1:"ddd"===this.token?this.locales.weekdaysShort[e]:"dddd"===this.token?this.locales.weekdays[e]:t;var i}},W}function Nt(){if(J)return B;J=1;const t=Vt();return B=class extends t{constructor(t={}){super(t)}up(){this.date.setHours(this.date.getHours()+1)}down(){this.date.setHours(this.date.getHours()-1)}setTo(t){this.date.setHours(parseInt(t.substr(-2)))}toString(){let t=this.date.getHours();return/h/.test(this.token)&&(t=t%12||12),this.token.length>1?String(t).padStart(2,"0"):t}},B}function Lt(){if(Z)return z;Z=1;const t=Vt();return z=class extends t{constructor(t={}){super(t)}up(){this.date.setMilliseconds(this.date.getMilliseconds()+1)}down(){this.date.setMilliseconds(this.date.getMilliseconds()-1)}setTo(t){this.date.setMilliseconds(parseInt(t.substr(-this.token.length)))}toString(){return String(this.date.getMilliseconds()).padStart(4,"0").substr(0,this.token.length)}}}function Yt(){if(Q)return K;Q=1;const t=Vt();return K=class extends t{constructor(t={}){super(t)}up(){this.date.setMinutes(this.date.getMinutes()+1)}down(){this.date.setMinutes(this.date.getMinutes()-1)}setTo(t){this.date.setMinutes(parseInt(t.substr(-2)))}toString(){let t=this.date.getMinutes();return this.token.length>1?String(t).padStart(2,"0"):t}}}function qt(){if(tt)return X;tt=1;const t=Vt();return X=class extends t{constructor(t={}){super(t)}up(){this.date.setMonth(this.date.getMonth()+1)}down(){this.date.setMonth(this.date.getMonth()-1)}setTo(t){t=parseInt(t.substr(-2))-1,this.date.setMonth(t<0?0:t)}toString(){let t=this.date.getMonth(),e=this.token.length;return 2===e?String(t+1).padStart(2,"0"):3===e?this.locales.monthsShort[t]:4===e?this.locales.months[t]:String(t+1)}},X}function Ut(){if(it)return et;it=1;const t=Vt();return et=class extends t{constructor(t={}){super(t)}up(){this.date.setSeconds(this.date.getSeconds()+1)}down(){this.date.setSeconds(this.date.getSeconds()-1)}setTo(t){this.date.setSeconds(parseInt(t.substr(-2)))}toString(){let t=this.date.getSeconds();return this.token.length>1?String(t).padStart(2,"0"):t}}}function Wt(){if(rt)return st;rt=1;const t=Vt();return st=class extends t{constructor(t={}){super(t)}up(){this.date.setFullYear(this.date.getFullYear()+1)}down(){this.date.setFullYear(this.date.getFullYear()-1)}setTo(t){this.date.setFullYear(t.substr(-4))}toString(){let t=String(this.date.getFullYear()).padStart(4,"0");return 2===this.token.length?t.substr(-2):t}},st}function Gt(){if(at)return ht;function t(t,e,i,s,r,n,o){try{var h=t[n](o),a=h.value}catch(t){return void i(t)}h.done?e(a):Promise.resolve(a).then(s,r)}function e(e){return function(){var i=this,s=arguments;return new Promise((function(r,n){var o=e.apply(i,s);function h(e){t(o,r,n,h,a,"next",e)}function a(e){t(o,r,n,h,a,"throw",e)}h(void 0)}))}}at=1;const i=Ct(),s=jt(),r=Pt(),n=r.style,o=r.clear,h=r.figures,a=At(),l=a.erase,u=a.cursor,c=ot?nt:(ot=1,nt={DatePart:Vt(),Meridiem:Ft(),Day:Rt(),Hours:Nt(),Milliseconds:Lt(),Minutes:Yt(),Month:qt(),Seconds:Ut(),Year:Wt()}),d=c.DatePart,p=c.Meridiem,m=c.Day,f=c.Hours,g=c.Milliseconds,v=c.Minutes,b=c.Month,y=c.Seconds,w=c.Year,_=/\\(.)|"((?:\\["\\]|[^"])+)"|(D[Do]?|d{3,4}|d)|(M{1,4})|(YY(?:YY)?)|([aA])|([Hh]{1,2})|(m{1,2})|(s{1,2})|(S{1,4})|./g,x={1:({token:t})=>t.replace(/\\(.)/g,"$1"),2:t=>new m(t),3:t=>new b(t),4:t=>new w(t),5:t=>new p(t),6:t=>new f(t),7:t=>new v(t),8:t=>new y(t),9:t=>new g(t)},O={months:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),monthsShort:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),weekdays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),weekdaysShort:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(",")};return ht=class extends s{constructor(t={}){super(t),this.msg=t.message,this.cursor=0,this.typed="",this.locales=Object.assign(O,t.locales),this._date=t.initial||new Date,this.errorMsg=t.error||"Please Enter A Valid Value",this.validator=t.validate||(()=>!0),this.mask=t.mask||"YYYY-MM-DD HH:mm:ss",this.clear=o("",this.out.columns),this.render()}get value(){return this.date}get date(){return this._date}set date(t){t&&this._date.setTime(t.getTime())}set mask(t){let e;for(this.parts=[];e=_.exec(t);){let t=e.shift(),i=e.findIndex((t=>null!=t));this.parts.push(i in x?x[i]({token:e[i]||t,date:this.date,parts:this.parts,locales:this.locales}):e[i]||t)}let i=this.parts.reduce(((t,e)=>("string"==typeof e&&"string"==typeof t[t.length-1]?t[t.length-1]+=e:t.push(e),t)),[]);this.parts.splice(0),this.parts.push(...i),this.reset()}moveCursor(t){this.typed="",this.cursor=t,this.fire()}reset(){this.moveCursor(this.parts.findIndex((t=>t instanceof d))),this.fire(),this.render()}exit(){this.abort()}abort(){this.done=this.aborted=!0,this.error=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}validate(){var t=this;return e((function*(){let e=yield t.validator(t.value);"string"==typeof e&&(t.errorMsg=e,e=!1),t.error=!e}))()}submit(){var t=this;return e((function*(){if(yield t.validate(),t.error)return t.color="red",t.fire(),void t.render();t.done=!0,t.aborted=!1,t.fire(),t.render(),t.out.write("\n"),t.close()}))()}up(){this.typed="",this.parts[this.cursor].up(),this.render()}down(){this.typed="",this.parts[this.cursor].down(),this.render()}left(){let t=this.parts[this.cursor].prev();if(null==t)return this.bell();this.moveCursor(this.parts.indexOf(t)),this.render()}right(){let t=this.parts[this.cursor].next();if(null==t)return this.bell();this.moveCursor(this.parts.indexOf(t)),this.render()}next(){let t=this.parts[this.cursor].next();this.moveCursor(t?this.parts.indexOf(t):this.parts.findIndex((t=>t instanceof d))),this.render()}_(t){/\d/.test(t)&&(this.typed+=t,this.parts[this.cursor].setTo(this.typed),this.render())}render(){this.closed||(this.firstRender?this.out.write(u.hide):this.out.write(o(this.outputText,this.out.columns)),super.render(),this.outputText=[n.symbol(this.done,this.aborted),i.bold(this.msg),n.delimiter(!1),this.parts.reduce(((t,e,s)=>t.concat(s!==this.cursor||this.done?e:i.cyan().underline(e.toString()))),[]).join("")].join(" "),this.error&&(this.outputText+=this.errorMsg.split("\n").reduce(((t,e,s)=>t+`\n${s?" ":h.pointerSmall} ${i.red().italic(e)}`),"")),this.out.write(l.line+u.to(0)+this.outputText))}},ht}function Bt(){if(ut)return lt;function t(t,e,i,s,r,n,o){try{var h=t[n](o),a=h.value}catch(t){return void i(t)}h.done?e(a):Promise.resolve(a).then(s,r)}function e(e){return function(){var i=this,s=arguments;return new Promise((function(r,n){var o=e.apply(i,s);function h(e){t(o,r,n,h,a,"next",e)}function a(e){t(o,r,n,h,a,"throw",e)}h(void 0)}))}}ut=1;const i=Ct(),s=jt(),r=At(),n=r.cursor,o=r.erase,h=Pt(),a=h.style,l=h.figures,u=h.clear,c=h.lines,d=/[0-9]/,p=t=>void 0!==t,m=(t,e)=>{let i=Math.pow(10,e);return Math.round(t*i)/i};return lt=class extends s{constructor(t={}){super(t),this.transform=a.render(t.style),this.msg=t.message,this.initial=p(t.initial)?t.initial:"",this.float=!!t.float,this.round=t.round||2,this.inc=t.increment||1,this.min=p(t.min)?t.min:-1/0,this.max=p(t.max)?t.max:1/0,this.errorMsg=t.error||"Please Enter A Valid Value",this.validator=t.validate||(()=>!0),this.color="cyan",this.value="",this.typed="",this.lastHit=0,this.render()}set value(t){t||0===t?(this.placeholder=!1,this.rendered=this.transform.render(`${m(t,this.round)}`),this._value=m(t,this.round)):(this.placeholder=!0,this.rendered=i.gray(this.transform.render(`${this.initial}`)),this._value=""),this.fire()}get value(){return this._value}parse(t){return this.float?parseFloat(t):parseInt(t)}valid(t){return"-"===t||"."===t&&this.float||d.test(t)}reset(){this.typed="",this.value="",this.fire(),this.render()}exit(){this.abort()}abort(){let t=this.value;this.value=""!==t?t:this.initial,this.done=this.aborted=!0,this.error=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}validate(){var t=this;return e((function*(){let e=yield t.validator(t.value);"string"==typeof e&&(t.errorMsg=e,e=!1),t.error=!e}))()}submit(){var t=this;return e((function*(){if(yield t.validate(),t.error)return t.color="red",t.fire(),void t.render();let e=t.value;t.value=""!==e?e:t.initial,t.done=!0,t.aborted=!1,t.error=!1,t.fire(),t.render(),t.out.write("\n"),t.close()}))()}up(){if(this.typed="",""===this.value&&(this.value=this.min-this.inc),this.value>=this.max)return this.bell();this.value+=this.inc,this.color="cyan",this.fire(),this.render()}down(){if(this.typed="",""===this.value&&(this.value=this.min+this.inc),this.value<=this.min)return this.bell();this.value-=this.inc,this.color="cyan",this.fire(),this.render()}delete(){let t=this.value.toString();if(0===t.length)return this.bell();this.value=this.parse(t=t.slice(0,-1))||"",""!==this.value&&this.value<this.min&&(this.value=this.min),this.color="cyan",this.fire(),this.render()}next(){this.value=this.initial,this.fire(),this.render()}_(t,e){if(!this.valid(t))return this.bell();const i=Date.now();if(i-this.lastHit>1e3&&(this.typed=""),this.typed+=t,this.lastHit=i,this.color="cyan","."===t)return this.fire();this.value=Math.min(this.parse(this.typed),this.max),this.value>this.max&&(this.value=this.max),this.value<this.min&&(this.value=this.min),this.fire(),this.render()}render(){this.closed||(this.firstRender||(this.outputError&&this.out.write(n.down(c(this.outputError,this.out.columns)-1)+u(this.outputError,this.out.columns)),this.out.write(u(this.outputText,this.out.columns))),super.render(),this.outputError="",this.outputText=[a.symbol(this.done,this.aborted),i.bold(this.msg),a.delimiter(this.done),this.done&&(this.done||this.placeholder)?this.rendered:i[this.color]().underline(this.rendered)].join(" "),this.error&&(this.outputError+=this.errorMsg.split("\n").reduce(((t,e,s)=>t+`\n${s?" ":l.pointerSmall} ${i.red().italic(e)}`),"")),this.out.write(o.line+n.to(0)+this.outputText+n.save+this.outputError+n.restore))}}}function Jt(){if(dt)return ct;dt=1;const t=Ct(),e=At().cursor,i=jt(),s=Pt(),r=s.clear,n=s.figures,o=s.style,h=s.wrap,a=s.entriesToDisplay;return ct=class extends i{constructor(t={}){super(t),this.msg=t.message,this.cursor=t.cursor||0,this.scrollIndex=t.cursor||0,this.hint=t.hint||"",this.warn=t.warn||"- This option is disabled -",this.minSelected=t.min,this.showMinError=!1,this.maxChoices=t.max,this.instructions=t.instructions,this.optionsPerPage=t.optionsPerPage||10,this.value=t.choices.map(((t,e)=>("string"==typeof t&&(t={title:t,value:e}),{title:t&&(t.title||t.value||t),description:t&&t.description,value:t&&(void 0===t.value?e:t.value),selected:t&&t.selected,disabled:t&&t.disabled}))),this.clear=r("",this.out.columns),t.overrideRender||this.render()}reset(){this.value.map((t=>!t.selected)),this.cursor=0,this.fire(),this.render()}selected(){return this.value.filter((t=>t.selected))}exit(){this.abort()}abort(){this.done=this.aborted=!0,this.fire(),this.render(),this.out.write("\n"),this.close()}submit(){const t=this.value.filter((t=>t.selected));this.minSelected&&t.length<this.minSelected?(this.showMinError=!0,this.render()):(this.done=!0,this.aborted=!1,this.fire(),this.render(),this.out.write("\n"),this.close())}first(){this.cursor=0,this.render()}last(){this.cursor=this.value.length-1,this.render()}next(){this.cursor=(this.cursor+1)%this.value.length,this.render()}up(){0===this.cursor?this.cursor=this.value.length-1:this.cursor--,this.render()}down(){this.cursor===this.value.length-1?this.cursor=0:this.cursor++,this.render()}left(){this.value[this.cursor].selected=!1,this.render()}right(){if(this.value.filter((t=>t.selected)).length>=this.maxChoices)return this.bell();this.value[this.cursor].selected=!0,this.render()}handleSpaceToggle(){const t=this.value[this.cursor];if(t.selected)t.selected=!1,this.render();else{if(t.disabled||this.value.filter((t=>t.selected)).length>=this.maxChoices)return this.bell();t.selected=!0,this.render()}}toggleAll(){if(void 0!==this.maxChoices||this.value[this.cursor].disabled)return this.bell();const t=!this.value[this.cursor].selected;this.value.filter((t=>!t.disabled)).forEach((e=>e.selected=t)),this.render()}_(t,e){if(" "===t)this.handleSpaceToggle();else{if("a"!==t)return this.bell();this.toggleAll()}}renderInstructions(){return void 0===this.instructions||this.instructions?"string"==typeof this.instructions?this.instructions:`\nInstructions:\n    ${n.arrowUp}/${n.arrowDown}: Highlight option\n    ${n.arrowLeft}/${n.arrowRight}/[space]: Toggle selection\n`+(void 0===this.maxChoices?"    a: Toggle all\n":"")+"    enter/return: Complete answer":""}renderOption(e,i,s,r){const o=(i.selected?t.green(n.radioOn):n.radioOff)+" "+r+" ";let a,l;return i.disabled?a=e===s?t.gray().underline(i.title):t.strikethrough().gray(i.title):(a=e===s?t.cyan().underline(i.title):i.title,e===s&&i.description&&(l=` - ${i.description}`,(o.length+a.length+l.length>=this.out.columns||i.description.split(/\r?\n/).length>1)&&(l="\n"+h(i.description,{margin:o.length,width:this.out.columns})))),o+a+t.gray(l||"")}paginateOptions(e){if(0===e.length)return t.red("No matches for this query.");let i,s=a(this.cursor,e.length,this.optionsPerPage),r=s.startIndex,o=s.endIndex,h=[];for(let t=r;t<o;t++)i=t===r&&r>0?n.arrowUp:t===o-1&&o<e.length?n.arrowDown:" ",h.push(this.renderOption(this.cursor,e[t],t,i));return"\n"+h.join("\n")}renderOptions(t){return this.done?"":this.paginateOptions(t)}renderDoneOrInstructions(){if(this.done)return this.value.filter((t=>t.selected)).map((t=>t.title)).join(", ");const e=[t.gray(this.hint),this.renderInstructions()];return this.value[this.cursor].disabled&&e.push(t.yellow(this.warn)),e.join(" ")}render(){if(this.closed)return;this.firstRender&&this.out.write(e.hide),super.render();let i=[o.symbol(this.done,this.aborted),t.bold(this.msg),o.delimiter(!1),this.renderDoneOrInstructions()].join(" ");this.showMinError&&(i+=t.red(`You must select a minimum of ${this.minSelected} choices.`),this.showMinError=!1),i+=this.renderOptions(this.value),this.out.write(this.clear+i),this.clear=r(i,this.out.columns)}},ct}function zt(){if(mt)return pt;function t(t,e,i,s,r,n,o){try{var h=t[n](o),a=h.value}catch(t){return void i(t)}h.done?e(a):Promise.resolve(a).then(s,r)}mt=1;const e=Ct(),i=jt(),s=At(),r=s.erase,n=s.cursor,o=Pt(),h=o.style,a=o.clear,l=o.figures,u=o.wrap,c=o.entriesToDisplay,d=(t,e)=>t[e]&&(t[e].value||t[e].title||t[e]),p=(t,e)=>t[e]&&(t[e].title||t[e].value||t[e]);return pt=class extends i{constructor(t={}){super(t),this.msg=t.message,this.suggest=t.suggest,this.choices=t.choices,this.initial="number"==typeof t.initial?t.initial:((t,e)=>{const i=t.findIndex((t=>t.value===e||t.title===e));return i>-1?i:void 0})(t.choices,t.initial),this.select=this.initial||t.cursor||0,this.i18n={noMatches:t.noMatches||"no matches found"},this.fallback=t.fallback||this.initial,this.clearFirst=t.clearFirst||!1,this.suggestions=[],this.input="",this.limit=t.limit||10,this.cursor=0,this.transform=h.render(t.style),this.scale=this.transform.scale,this.render=this.render.bind(this),this.complete=this.complete.bind(this),this.clear=a("",this.out.columns),this.complete(this.render),this.render()}set fallback(t){this._fb=Number.isSafeInteger(parseInt(t))?parseInt(t):t}get fallback(){let t;return"number"==typeof this._fb?t=this.choices[this._fb]:"string"==typeof this._fb&&(t={title:this._fb}),t||this._fb||{title:this.i18n.noMatches}}moveSelect(t){this.select=t,this.suggestions.length>0?this.value=d(this.suggestions,t):this.value=this.fallback.value,this.fire()}complete(e){var i,s=this;return(i=function*(){const t=s.completing=s.suggest(s.input,s.choices),i=yield t;if(s.completing!==t)return;s.suggestions=i.map(((t,e,i)=>({title:p(i,e),value:d(i,e),description:t.description}))),s.completing=!1;const r=Math.max(i.length-1,0);s.moveSelect(Math.min(r,s.select)),e&&e()},function(){var e=this,s=arguments;return new Promise((function(r,n){var o=i.apply(e,s);function h(e){t(o,r,n,h,a,"next",e)}function a(e){t(o,r,n,h,a,"throw",e)}h(void 0)}))})()}reset(){this.input="",this.complete((()=>{this.moveSelect(void 0!==this.initial?this.initial:0),this.render()})),this.render()}exit(){this.clearFirst&&this.input.length>0?this.reset():(this.done=this.exited=!0,this.aborted=!1,this.fire(),this.render(),this.out.write("\n"),this.close())}abort(){this.done=this.aborted=!0,this.exited=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}submit(){this.done=!0,this.aborted=this.exited=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}_(t,e){let i=this.input.slice(0,this.cursor),s=this.input.slice(this.cursor);this.input=`${i}${t}${s}`,this.cursor=i.length+1,this.complete(this.render),this.render()}delete(){if(0===this.cursor)return this.bell();let t=this.input.slice(0,this.cursor-1),e=this.input.slice(this.cursor);this.input=`${t}${e}`,this.complete(this.render),this.cursor=this.cursor-1,this.render()}deleteForward(){if(this.cursor*this.scale>=this.rendered.length)return this.bell();let t=this.input.slice(0,this.cursor),e=this.input.slice(this.cursor+1);this.input=`${t}${e}`,this.complete(this.render),this.render()}first(){this.moveSelect(0),this.render()}last(){this.moveSelect(this.suggestions.length-1),this.render()}up(){0===this.select?this.moveSelect(this.suggestions.length-1):this.moveSelect(this.select-1),this.render()}down(){this.select===this.suggestions.length-1?this.moveSelect(0):this.moveSelect(this.select+1),this.render()}next(){this.select===this.suggestions.length-1?this.moveSelect(0):this.moveSelect(this.select+1),this.render()}nextPage(){this.moveSelect(Math.min(this.select+this.limit,this.suggestions.length-1)),this.render()}prevPage(){this.moveSelect(Math.max(this.select-this.limit,0)),this.render()}left(){if(this.cursor<=0)return this.bell();this.cursor=this.cursor-1,this.render()}right(){if(this.cursor*this.scale>=this.rendered.length)return this.bell();this.cursor=this.cursor+1,this.render()}renderOption(t,i,s,r){let n,o=s?l.arrowUp:r?l.arrowDown:" ",h=i?e.cyan().underline(t.title):t.title;return o=(i?e.cyan(l.pointer)+" ":"  ")+o,t.description&&(n=` - ${t.description}`,(o.length+h.length+n.length>=this.out.columns||t.description.split(/\r?\n/).length>1)&&(n="\n"+u(t.description,{margin:3,width:this.out.columns}))),o+" "+h+e.gray(n||"")}render(){if(this.closed)return;this.firstRender?this.out.write(n.hide):this.out.write(a(this.outputText,this.out.columns)),super.render();let t=c(this.select,this.choices.length,this.limit),i=t.startIndex,s=t.endIndex;if(this.outputText=[h.symbol(this.done,this.aborted,this.exited),e.bold(this.msg),h.delimiter(this.completing),this.done&&this.suggestions[this.select]?this.suggestions[this.select].title:this.rendered=this.transform.render(this.input)].join(" "),!this.done){const t=this.suggestions.slice(i,s).map(((t,e)=>this.renderOption(t,this.select===e+i,0===e&&i>0,e+i===s-1&&s<this.choices.length))).join("\n");this.outputText+="\n"+(t||e.gray(this.fallback.title))}this.out.write(r.line+n.to(0)+this.outputText)}},pt}function Zt(){if(gt)return ft;gt=1;const t=Ct(),e=At().cursor,i=Jt(),s=Pt(),r=s.clear,n=s.style,o=s.figures;return ft=class extends i{constructor(t={}){t.overrideRender=!0,super(t),this.inputValue="",this.clear=r("",this.out.columns),this.filteredOptions=this.value,this.render()}last(){this.cursor=this.filteredOptions.length-1,this.render()}next(){this.cursor=(this.cursor+1)%this.filteredOptions.length,this.render()}up(){0===this.cursor?this.cursor=this.filteredOptions.length-1:this.cursor--,this.render()}down(){this.cursor===this.filteredOptions.length-1?this.cursor=0:this.cursor++,this.render()}left(){this.filteredOptions[this.cursor].selected=!1,this.render()}right(){if(this.value.filter((t=>t.selected)).length>=this.maxChoices)return this.bell();this.filteredOptions[this.cursor].selected=!0,this.render()}delete(){this.inputValue.length&&(this.inputValue=this.inputValue.substr(0,this.inputValue.length-1),this.updateFilteredOptions())}updateFilteredOptions(){const t=this.filteredOptions[this.cursor];this.filteredOptions=this.value.filter((t=>!this.inputValue||(!("string"!=typeof t.title||!t.title.toLowerCase().includes(this.inputValue.toLowerCase()))||!("string"!=typeof t.value||!t.value.toLowerCase().includes(this.inputValue.toLowerCase())))));const e=this.filteredOptions.findIndex((e=>e===t));this.cursor=e<0?0:e,this.render()}handleSpaceToggle(){const t=this.filteredOptions[this.cursor];if(t.selected)t.selected=!1,this.render();else{if(t.disabled||this.value.filter((t=>t.selected)).length>=this.maxChoices)return this.bell();t.selected=!0,this.render()}}handleInputChange(t){this.inputValue=this.inputValue+t,this.updateFilteredOptions()}_(t,e){" "===t?this.handleSpaceToggle():this.handleInputChange(t)}renderInstructions(){return void 0===this.instructions||this.instructions?"string"==typeof this.instructions?this.instructions:`\nInstructions:\n    ${o.arrowUp}/${o.arrowDown}: Highlight option\n    ${o.arrowLeft}/${o.arrowRight}/[space]: Toggle selection\n    [a,b,c]/delete: Filter choices\n    enter/return: Complete answer\n`:""}renderCurrentInput(){return`\nFiltered results for: ${this.inputValue?this.inputValue:t.gray("Enter something to filter")}\n`}renderOption(e,i,s){let r;return r=i.disabled?e===s?t.gray().underline(i.title):t.strikethrough().gray(i.title):e===s?t.cyan().underline(i.title):i.title,(i.selected?t.green(o.radioOn):o.radioOff)+"  "+r}renderDoneOrInstructions(){if(this.done)return this.value.filter((t=>t.selected)).map((t=>t.title)).join(", ");const e=[t.gray(this.hint),this.renderInstructions(),this.renderCurrentInput()];return this.filteredOptions.length&&this.filteredOptions[this.cursor].disabled&&e.push(t.yellow(this.warn)),e.join(" ")}render(){if(this.closed)return;this.firstRender&&this.out.write(e.hide),super.render();let i=[n.symbol(this.done,this.aborted),t.bold(this.msg),n.delimiter(!1),this.renderDoneOrInstructions()].join(" ");this.showMinError&&(i+=t.red(`You must select a minimum of ${this.minSelected} choices.`),this.showMinError=!1),i+=this.renderOptions(this.filteredOptions),this.out.write(this.clear+i),this.clear=r(i,this.out.columns)}},ft}function Kt(){if(bt)return vt;bt=1;const t=Ct(),e=jt(),i=Pt(),s=i.style,r=i.clear,n=At(),o=n.erase,h=n.cursor;return vt=class extends e{constructor(t={}){super(t),this.msg=t.message,this.value=t.initial,this.initialValue=!!t.initial,this.yesMsg=t.yes||"yes",this.yesOption=t.yesOption||"(Y/n)",this.noMsg=t.no||"no",this.noOption=t.noOption||"(y/N)",this.render()}reset(){this.value=this.initialValue,this.fire(),this.render()}exit(){this.abort()}abort(){this.done=this.aborted=!0,this.fire(),this.render(),this.out.write("\n"),this.close()}submit(){this.value=this.value||!1,this.done=!0,this.aborted=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}_(t,e){return"y"===t.toLowerCase()?(this.value=!0,this.submit()):"n"===t.toLowerCase()?(this.value=!1,this.submit()):this.bell()}render(){this.closed||(this.firstRender?this.out.write(h.hide):this.out.write(r(this.outputText,this.out.columns)),super.render(),this.outputText=[s.symbol(this.done,this.aborted),t.bold(this.msg),s.delimiter(this.done),this.done?this.value?this.yesMsg:this.noMsg:t.gray(this.initialValue?this.yesOption:this.noOption)].join(" "),this.out.write(o.line+h.to(0)+this.outputText))}}}function Qt(){return _t||(_t=1,function(t){const e=St,i=wt?yt:(wt=1,yt={TextPrompt:It(),SelectPrompt:Dt(),TogglePrompt:Ht(),DatePrompt:Gt(),NumberPrompt:Bt(),MultiselectPrompt:Jt(),AutocompletePrompt:zt(),AutocompleteMultiselectPrompt:Zt(),ConfirmPrompt:Kt()}),s=t=>t;function r(t,e,r={}){return new Promise(((n,o)=>{const h=new i[t](e),a=r.onAbort||s,l=r.onSubmit||s,u=r.onExit||s;h.on("state",e.onState||s),h.on("submit",(t=>n(l(t)))),h.on("exit",(t=>n(u(t)))),h.on("abort",(t=>o(a(t))))}))}e.text=t=>r("TextPrompt",t),e.password=t=>(t.style="password",e.text(t)),e.invisible=t=>(t.style="invisible",e.text(t)),e.number=t=>r("NumberPrompt",t),e.date=t=>r("DatePrompt",t),e.confirm=t=>r("ConfirmPrompt",t),e.list=t=>{const e=t.separator||",";return r("TextPrompt",t,{onSubmit:t=>t.split(e).map((t=>t.trim()))})},e.toggle=t=>r("TogglePrompt",t),e.select=t=>r("SelectPrompt",t),e.multiselect=t=>{t.choices=[].concat(t.choices||[]);const e=t=>t.filter((t=>t.selected)).map((t=>t.value));return r("MultiselectPrompt",t,{onAbort:e,onSubmit:e})},e.autocompleteMultiselect=t=>{t.choices=[].concat(t.choices||[]);const e=t=>t.filter((t=>t.selected)).map((t=>t.value));return r("AutocompleteMultiselectPrompt",t,{onAbort:e,onSubmit:e})};const n=(t,e)=>Promise.resolve(e.filter((e=>e.title.slice(0,t.length).toLowerCase()===t.toLowerCase())));e.autocomplete=t=>(t.suggest=t.suggest||n,t.choices=[].concat(t.choices||[]),r("AutocompletePrompt",t))}()),St}var Xt,te,ee,ie,se,re,ne,oe,he,ae,le,ue,ce,de,pe,me,fe,ge,ve,be,ye,we,_e,xe,Oe,Se,Ce,$e,Ae,Me,ke,Ee,Te,Pe,je,Ie,De,He,Ve,Fe,Re,Ne,Le,Ye,qe,Ue,We,Ge,Be,Je,ze,Ze,Ke,Qe,Xe,ti,ei,ii,si,ri,ni,oi,hi,ai={};function li(){return ie?ee:(ie=1,ee=t=>{const e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PRZcf-ntqry=><~]))"].join("|"),i=new RegExp(e,"g");return"string"==typeof t?t.replace(i,""):t})}function ui(){if(re)return se;re=1;const t=li(),{erase:e,cursor:i}=At();return se=function(s,r){if(!r)return e.line+i.to(0);let n=0;const o=s.split(/\r?\n/);for(let e of o)n+=1+Math.floor(Math.max([...t(e)].length-1,0)/r);return e.lines(n)},se}function ci(){if(oe)return ne;oe=1;const t={arrowUp:"↑",arrowDown:"↓",arrowLeft:"←",arrowRight:"→",radioOn:"◉",radioOff:"◯",tick:"✔",cross:"✖",ellipsis:"…",pointerSmall:"›",line:"─",pointer:"❯"},e={arrowUp:t.arrowUp,arrowDown:t.arrowDown,arrowLeft:t.arrowLeft,arrowRight:t.arrowRight,radioOn:"(*)",radioOff:"( )",tick:"√",cross:"×",ellipsis:"...",pointerSmall:"»",line:"─",pointer:">"},i="win32"===process.platform?e:t;return ne=i}function di(){if(ae)return he;ae=1;const t=Ct(),e=ci(),i=Object.freeze({password:{scale:1,render:t=>"*".repeat(t.length)},emoji:{scale:2,render:t=>"😃".repeat(t.length)},invisible:{scale:0,render:t=>""},default:{scale:1,render:t=>`${t}`}}),s=Object.freeze({aborted:t.red(e.cross),done:t.green(e.tick),exited:t.yellow(e.cross),default:t.cyan("?")});return he={styles:i,render:t=>i[t]||i.default,symbols:s,symbol:(t,e,i)=>e?s.aborted:i?s.exited:t?s.done:s.default,delimiter:i=>t.gray(i?e.ellipsis:e.pointerSmall),item:(i,s)=>t.gray(i?s?e.pointerSmall:"+":e.line)}}function pi(){if(ue)return le;ue=1;const t=li();return le=function(e,i){let s=String(t(e)||"").split(/\r?\n/);return i?s.map((t=>Math.ceil(t.length/i))).reduce(((t,e)=>t+e)):s.length}}function mi(){return ge?fe:(ge=1,fe={action:te?Xt:(te=1,Xt=(t,e)=>{if(!t.meta||"escape"===t.name){if(t.ctrl){if("a"===t.name)return"first";if("c"===t.name)return"abort";if("d"===t.name)return"abort";if("e"===t.name)return"last";if("g"===t.name)return"reset"}if(e){if("j"===t.name)return"down";if("k"===t.name)return"up"}return"return"===t.name||"enter"===t.name?"submit":"backspace"===t.name?"delete":"delete"===t.name?"deleteForward":"abort"===t.name?"abort":"escape"===t.name?"exit":"tab"===t.name?"next":"pagedown"===t.name?"nextPage":"pageup"===t.name?"prevPage":"home"===t.name?"home":"end"===t.name?"end":"up"===t.name?"up":"down"===t.name?"down":"right"===t.name?"right":"left"===t.name&&"left"}}),clear:ui(),style:di(),strip:li(),figures:ci(),lines:pi(),wrap:de?ce:(de=1,ce=(t,e={})=>{const i=Number.isSafeInteger(parseInt(e.margin))?new Array(parseInt(e.margin)).fill(" ").join(""):e.margin||"",s=e.width;return(t||"").split(/\r?\n/g).map((t=>t.split(/\s+/g).reduce(((t,e)=>(e.length+i.length>=s||t[t.length-1].length+e.length+1<s?t[t.length-1]+=` ${e}`:t.push(`${i}${e}`),t)),[i]).join("\n"))).join("\n")}),entriesToDisplay:me?pe:(me=1,pe=(t,e,i)=>{i=i||e;let s=Math.min(e-i,t-Math.floor(i/2));return s<0&&(s=0),{startIndex:s,endIndex:Math.min(s+i,e)}})})}function fi(){if(be)return ve;be=1;const t=s,{action:e}=mi(),i=r,{beep:n,cursor:o}=At(),h=Ct();return ve=class extends i{constructor(i={}){super(),this.firstRender=!0,this.in=i.stdin||process.stdin,this.out=i.stdout||process.stdout,this.onRender=(i.onRender||(()=>{})).bind(this);const s=t.createInterface({input:this.in,escapeCodeTimeout:50});t.emitKeypressEvents(this.in,s),this.in.isTTY&&this.in.setRawMode(!0);const r=["SelectPrompt","MultiselectPrompt"].indexOf(this.constructor.name)>-1,n=(t,i)=>{let s=e(i,r);!1===s?this._&&this._(t,i):"function"==typeof this[s]?this[s](i):this.bell()};this.close=()=>{this.out.write(o.show),this.in.removeListener("keypress",n),this.in.isTTY&&this.in.setRawMode(!1),s.close(),this.emit(this.aborted?"abort":this.exited?"exit":"submit",this.value),this.closed=!0},this.in.on("keypress",n)}fire(){this.emit("state",{value:this.value,aborted:!!this.aborted,exited:!!this.exited})}bell(){this.out.write(n)}render(){this.onRender(h),this.firstRender&&(this.firstRender=!1)}}}function gi(){if(we)return ye;we=1;const t=Ct(),e=fi(),{erase:i,cursor:s}=At(),{style:r,clear:n,lines:o,figures:h}=mi();return ye=class extends e{constructor(t={}){super(t),this.transform=r.render(t.style),this.scale=this.transform.scale,this.msg=t.message,this.initial=t.initial||"",this.validator=t.validate||(()=>!0),this.value="",this.errorMsg=t.error||"Please Enter A Valid Value",this.cursor=Number(!!this.initial),this.cursorOffset=0,this.clear=n("",this.out.columns),this.render()}set value(e){!e&&this.initial?(this.placeholder=!0,this.rendered=t.gray(this.transform.render(this.initial))):(this.placeholder=!1,this.rendered=this.transform.render(e)),this._value=e,this.fire()}get value(){return this._value}reset(){this.value="",this.cursor=Number(!!this.initial),this.cursorOffset=0,this.fire(),this.render()}exit(){this.abort()}abort(){this.value=this.value||this.initial,this.done=this.aborted=!0,this.error=!1,this.red=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}async validate(){let t=await this.validator(this.value);"string"==typeof t&&(this.errorMsg=t,t=!1),this.error=!t}async submit(){if(this.value=this.value||this.initial,this.cursorOffset=0,this.cursor=this.rendered.length,await this.validate(),this.error)return this.red=!0,this.fire(),void this.render();this.done=!0,this.aborted=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}next(){if(!this.placeholder)return this.bell();this.value=this.initial,this.cursor=this.rendered.length,this.fire(),this.render()}moveCursor(t){this.placeholder||(this.cursor=this.cursor+t,this.cursorOffset+=t)}_(t,e){let i=this.value.slice(0,this.cursor),s=this.value.slice(this.cursor);this.value=`${i}${t}${s}`,this.red=!1,this.cursor=this.placeholder?0:i.length+1,this.render()}delete(){if(this.isCursorAtStart())return this.bell();let t=this.value.slice(0,this.cursor-1),e=this.value.slice(this.cursor);this.value=`${t}${e}`,this.red=!1,this.isCursorAtStart()?this.cursorOffset=0:(this.cursorOffset++,this.moveCursor(-1)),this.render()}deleteForward(){if(this.cursor*this.scale>=this.rendered.length||this.placeholder)return this.bell();let t=this.value.slice(0,this.cursor),e=this.value.slice(this.cursor+1);this.value=`${t}${e}`,this.red=!1,this.isCursorAtEnd()?this.cursorOffset=0:this.cursorOffset++,this.render()}first(){this.cursor=0,this.render()}last(){this.cursor=this.value.length,this.render()}left(){if(this.cursor<=0||this.placeholder)return this.bell();this.moveCursor(-1),this.render()}right(){if(this.cursor*this.scale>=this.rendered.length||this.placeholder)return this.bell();this.moveCursor(1),this.render()}isCursorAtStart(){return 0===this.cursor||this.placeholder&&1===this.cursor}isCursorAtEnd(){return this.cursor===this.rendered.length||this.placeholder&&this.cursor===this.rendered.length+1}render(){this.closed||(this.firstRender||(this.outputError&&this.out.write(s.down(o(this.outputError,this.out.columns)-1)+n(this.outputError,this.out.columns)),this.out.write(n(this.outputText,this.out.columns))),super.render(),this.outputError="",this.outputText=[r.symbol(this.done,this.aborted),t.bold(this.msg),r.delimiter(this.done),this.red?t.red(this.rendered):this.rendered].join(" "),this.error&&(this.outputError+=this.errorMsg.split("\n").reduce(((e,i,s)=>e+`\n${s?" ":h.pointerSmall} ${t.red().italic(i)}`),"")),this.out.write(i.line+s.to(0)+this.outputText+s.save+this.outputError+s.restore+s.move(this.cursorOffset,0)))}}}function vi(){if(xe)return _e;xe=1;const t=Ct(),e=fi(),{style:i,clear:s,figures:r,wrap:n,entriesToDisplay:o}=mi(),{cursor:h}=At();return _e=class extends e{constructor(t={}){super(t),this.msg=t.message,this.hint=t.hint||"- Use arrow-keys. Return to submit.",this.warn=t.warn||"- This option is disabled",this.cursor=t.initial||0,this.choices=t.choices.map(((t,e)=>("string"==typeof t&&(t={title:t,value:e}),{title:t&&(t.title||t.value||t),value:t&&(void 0===t.value?e:t.value),description:t&&t.description,selected:t&&t.selected,disabled:t&&t.disabled}))),this.optionsPerPage=t.optionsPerPage||10,this.value=(this.choices[this.cursor]||{}).value,this.clear=s("",this.out.columns),this.render()}moveCursor(t){this.cursor=t,this.value=this.choices[t].value,this.fire()}reset(){this.moveCursor(0),this.fire(),this.render()}exit(){this.abort()}abort(){this.done=this.aborted=!0,this.fire(),this.render(),this.out.write("\n"),this.close()}submit(){this.selection.disabled?this.bell():(this.done=!0,this.aborted=!1,this.fire(),this.render(),this.out.write("\n"),this.close())}first(){this.moveCursor(0),this.render()}last(){this.moveCursor(this.choices.length-1),this.render()}up(){0===this.cursor?this.moveCursor(this.choices.length-1):this.moveCursor(this.cursor-1),this.render()}down(){this.cursor===this.choices.length-1?this.moveCursor(0):this.moveCursor(this.cursor+1),this.render()}next(){this.moveCursor((this.cursor+1)%this.choices.length),this.render()}_(t,e){if(" "===t)return this.submit()}get selection(){return this.choices[this.cursor]}render(){if(this.closed)return;this.firstRender?this.out.write(h.hide):this.out.write(s(this.outputText,this.out.columns)),super.render();let{startIndex:e,endIndex:a}=o(this.cursor,this.choices.length,this.optionsPerPage);if(this.outputText=[i.symbol(this.done,this.aborted),t.bold(this.msg),i.delimiter(!1),this.done?this.selection.title:this.selection.disabled?t.yellow(this.warn):t.gray(this.hint)].join(" "),!this.done){this.outputText+="\n";for(let i=e;i<a;i++){let s,o,h="",l=this.choices[i];o=i===e&&e>0?r.arrowUp:i===a-1&&a<this.choices.length?r.arrowDown:" ",l.disabled?(s=this.cursor===i?t.gray().underline(l.title):t.strikethrough().gray(l.title),o=(this.cursor===i?t.bold().gray(r.pointer)+" ":"  ")+o):(s=this.cursor===i?t.cyan().underline(l.title):l.title,o=(this.cursor===i?t.cyan(r.pointer)+" ":"  ")+o,l.description&&this.cursor===i&&(h=` - ${l.description}`,(o.length+s.length+h.length>=this.out.columns||l.description.split(/\r?\n/).length>1)&&(h="\n"+n(l.description,{margin:3,width:this.out.columns})))),this.outputText+=`${o} ${s}${t.gray(h)}\n`}}this.out.write(this.outputText)}}}function bi(){if(Se)return Oe;Se=1;const t=Ct(),e=fi(),{style:i,clear:s}=mi(),{cursor:r,erase:n}=At();return Oe=class extends e{constructor(t={}){super(t),this.msg=t.message,this.value=!!t.initial,this.active=t.active||"on",this.inactive=t.inactive||"off",this.initialValue=this.value,this.render()}reset(){this.value=this.initialValue,this.fire(),this.render()}exit(){this.abort()}abort(){this.done=this.aborted=!0,this.fire(),this.render(),this.out.write("\n"),this.close()}submit(){this.done=!0,this.aborted=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}deactivate(){if(!1===this.value)return this.bell();this.value=!1,this.render()}activate(){if(!0===this.value)return this.bell();this.value=!0,this.render()}delete(){this.deactivate()}left(){this.deactivate()}right(){this.activate()}down(){this.deactivate()}up(){this.activate()}next(){this.value=!this.value,this.fire(),this.render()}_(t,e){if(" "===t)this.value=!this.value;else if("1"===t)this.value=!0;else{if("0"!==t)return this.bell();this.value=!1}this.render()}render(){this.closed||(this.firstRender?this.out.write(r.hide):this.out.write(s(this.outputText,this.out.columns)),super.render(),this.outputText=[i.symbol(this.done,this.aborted),t.bold(this.msg),i.delimiter(this.done),this.value?this.inactive:t.cyan().underline(this.inactive),t.gray("/"),this.value?t.cyan().underline(this.active):this.active].join(" "),this.out.write(n.line+r.to(0)+this.outputText))}}}function yi(){if($e)return Ce;$e=1;class t{constructor({token:t,date:e,parts:i,locales:s}){this.token=t,this.date=e||new Date,this.parts=i||[this],this.locales=s||{}}up(){}down(){}next(){const e=this.parts.indexOf(this);return this.parts.find(((i,s)=>s>e&&i instanceof t))}setTo(t){}prev(){let e=[].concat(this.parts).reverse();const i=e.indexOf(this);return e.find(((e,s)=>s>i&&e instanceof t))}toString(){return String(this.date)}}return Ce=t}function wi(){if(Me)return Ae;Me=1;const t=yi();return Ae=class extends t{constructor(t={}){super(t)}up(){this.date.setHours((this.date.getHours()+12)%24)}down(){this.up()}toString(){let t=this.date.getHours()>12?"pm":"am";return/\A/.test(this.token)?t.toUpperCase():t}}}function _i(){if(Ee)return ke;Ee=1;const t=yi();return ke=class extends t{constructor(t={}){super(t)}up(){this.date.setDate(this.date.getDate()+1)}down(){this.date.setDate(this.date.getDate()-1)}setTo(t){this.date.setDate(parseInt(t.substr(-2)))}toString(){let t=this.date.getDate(),e=this.date.getDay();return"DD"===this.token?String(t).padStart(2,"0"):"Do"===this.token?t+(i=t,1==(i%=10)?"st":2===i?"nd":3===i?"rd":"th"):"d"===this.token?e+1:"ddd"===this.token?this.locales.weekdaysShort[e]:"dddd"===this.token?this.locales.weekdays[e]:t;var i}},ke}function xi(){if(Pe)return Te;Pe=1;const t=yi();return Te=class extends t{constructor(t={}){super(t)}up(){this.date.setHours(this.date.getHours()+1)}down(){this.date.setHours(this.date.getHours()-1)}setTo(t){this.date.setHours(parseInt(t.substr(-2)))}toString(){let t=this.date.getHours();return/h/.test(this.token)&&(t=t%12||12),this.token.length>1?String(t).padStart(2,"0"):t}}}function Oi(){if(Ie)return je;Ie=1;const t=yi();return je=class extends t{constructor(t={}){super(t)}up(){this.date.setMilliseconds(this.date.getMilliseconds()+1)}down(){this.date.setMilliseconds(this.date.getMilliseconds()-1)}setTo(t){this.date.setMilliseconds(parseInt(t.substr(-this.token.length)))}toString(){return String(this.date.getMilliseconds()).padStart(4,"0").substr(0,this.token.length)}}}function Si(){if(He)return De;He=1;const t=yi();return De=class extends t{constructor(t={}){super(t)}up(){this.date.setMinutes(this.date.getMinutes()+1)}down(){this.date.setMinutes(this.date.getMinutes()-1)}setTo(t){this.date.setMinutes(parseInt(t.substr(-2)))}toString(){let t=this.date.getMinutes();return this.token.length>1?String(t).padStart(2,"0"):t}}}function Ci(){if(Fe)return Ve;Fe=1;const t=yi();return Ve=class extends t{constructor(t={}){super(t)}up(){this.date.setMonth(this.date.getMonth()+1)}down(){this.date.setMonth(this.date.getMonth()-1)}setTo(t){t=parseInt(t.substr(-2))-1,this.date.setMonth(t<0?0:t)}toString(){let t=this.date.getMonth(),e=this.token.length;return 2===e?String(t+1).padStart(2,"0"):3===e?this.locales.monthsShort[t]:4===e?this.locales.months[t]:String(t+1)}}}function $i(){if(Ne)return Re;Ne=1;const t=yi();return Re=class extends t{constructor(t={}){super(t)}up(){this.date.setSeconds(this.date.getSeconds()+1)}down(){this.date.setSeconds(this.date.getSeconds()-1)}setTo(t){this.date.setSeconds(parseInt(t.substr(-2)))}toString(){let t=this.date.getSeconds();return this.token.length>1?String(t).padStart(2,"0"):t}}}function Ai(){if(Ye)return Le;Ye=1;const t=yi();return Le=class extends t{constructor(t={}){super(t)}up(){this.date.setFullYear(this.date.getFullYear()+1)}down(){this.date.setFullYear(this.date.getFullYear()-1)}setTo(t){this.date.setFullYear(t.substr(-4))}toString(){let t=String(this.date.getFullYear()).padStart(4,"0");return 2===this.token.length?t.substr(-2):t}}}function Mi(){if(Ge)return We;Ge=1;const t=Ct(),e=fi(),{style:i,clear:s,figures:r}=mi(),{erase:n,cursor:o}=At(),{DatePart:h,Meridiem:a,Day:l,Hours:u,Milliseconds:c,Minutes:d,Month:p,Seconds:m,Year:f}=Ue?qe:(Ue=1,qe={DatePart:yi(),Meridiem:wi(),Day:_i(),Hours:xi(),Milliseconds:Oi(),Minutes:Si(),Month:Ci(),Seconds:$i(),Year:Ai()}),g=/\\(.)|"((?:\\["\\]|[^"])+)"|(D[Do]?|d{3,4}|d)|(M{1,4})|(YY(?:YY)?)|([aA])|([Hh]{1,2})|(m{1,2})|(s{1,2})|(S{1,4})|./g,v={1:({token:t})=>t.replace(/\\(.)/g,"$1"),2:t=>new l(t),3:t=>new p(t),4:t=>new f(t),5:t=>new a(t),6:t=>new u(t),7:t=>new d(t),8:t=>new m(t),9:t=>new c(t)},b={months:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),monthsShort:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),weekdays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),weekdaysShort:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(",")};return We=class extends e{constructor(t={}){super(t),this.msg=t.message,this.cursor=0,this.typed="",this.locales=Object.assign(b,t.locales),this._date=t.initial||new Date,this.errorMsg=t.error||"Please Enter A Valid Value",this.validator=t.validate||(()=>!0),this.mask=t.mask||"YYYY-MM-DD HH:mm:ss",this.clear=s("",this.out.columns),this.render()}get value(){return this.date}get date(){return this._date}set date(t){t&&this._date.setTime(t.getTime())}set mask(t){let e;for(this.parts=[];e=g.exec(t);){let t=e.shift(),i=e.findIndex((t=>null!=t));this.parts.push(i in v?v[i]({token:e[i]||t,date:this.date,parts:this.parts,locales:this.locales}):e[i]||t)}let i=this.parts.reduce(((t,e)=>("string"==typeof e&&"string"==typeof t[t.length-1]?t[t.length-1]+=e:t.push(e),t)),[]);this.parts.splice(0),this.parts.push(...i),this.reset()}moveCursor(t){this.typed="",this.cursor=t,this.fire()}reset(){this.moveCursor(this.parts.findIndex((t=>t instanceof h))),this.fire(),this.render()}exit(){this.abort()}abort(){this.done=this.aborted=!0,this.error=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}async validate(){let t=await this.validator(this.value);"string"==typeof t&&(this.errorMsg=t,t=!1),this.error=!t}async submit(){if(await this.validate(),this.error)return this.color="red",this.fire(),void this.render();this.done=!0,this.aborted=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}up(){this.typed="",this.parts[this.cursor].up(),this.render()}down(){this.typed="",this.parts[this.cursor].down(),this.render()}left(){let t=this.parts[this.cursor].prev();if(null==t)return this.bell();this.moveCursor(this.parts.indexOf(t)),this.render()}right(){let t=this.parts[this.cursor].next();if(null==t)return this.bell();this.moveCursor(this.parts.indexOf(t)),this.render()}next(){let t=this.parts[this.cursor].next();this.moveCursor(t?this.parts.indexOf(t):this.parts.findIndex((t=>t instanceof h))),this.render()}_(t){/\d/.test(t)&&(this.typed+=t,this.parts[this.cursor].setTo(this.typed),this.render())}render(){this.closed||(this.firstRender?this.out.write(o.hide):this.out.write(s(this.outputText,this.out.columns)),super.render(),this.outputText=[i.symbol(this.done,this.aborted),t.bold(this.msg),i.delimiter(!1),this.parts.reduce(((e,i,s)=>e.concat(s!==this.cursor||this.done?i:t.cyan().underline(i.toString()))),[]).join("")].join(" "),this.error&&(this.outputText+=this.errorMsg.split("\n").reduce(((e,i,s)=>e+`\n${s?" ":r.pointerSmall} ${t.red().italic(i)}`),"")),this.out.write(n.line+o.to(0)+this.outputText))}}}function ki(){if(Je)return Be;Je=1;const t=Ct(),e=fi(),{cursor:i,erase:s}=At(),{style:r,figures:n,clear:o,lines:h}=mi(),a=/[0-9]/,l=t=>void 0!==t,u=(t,e)=>{let i=Math.pow(10,e);return Math.round(t*i)/i};return Be=class extends e{constructor(t={}){super(t),this.transform=r.render(t.style),this.msg=t.message,this.initial=l(t.initial)?t.initial:"",this.float=!!t.float,this.round=t.round||2,this.inc=t.increment||1,this.min=l(t.min)?t.min:-1/0,this.max=l(t.max)?t.max:1/0,this.errorMsg=t.error||"Please Enter A Valid Value",this.validator=t.validate||(()=>!0),this.color="cyan",this.value="",this.typed="",this.lastHit=0,this.render()}set value(e){e||0===e?(this.placeholder=!1,this.rendered=this.transform.render(`${u(e,this.round)}`),this._value=u(e,this.round)):(this.placeholder=!0,this.rendered=t.gray(this.transform.render(`${this.initial}`)),this._value=""),this.fire()}get value(){return this._value}parse(t){return this.float?parseFloat(t):parseInt(t)}valid(t){return"-"===t||"."===t&&this.float||a.test(t)}reset(){this.typed="",this.value="",this.fire(),this.render()}exit(){this.abort()}abort(){let t=this.value;this.value=""!==t?t:this.initial,this.done=this.aborted=!0,this.error=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}async validate(){let t=await this.validator(this.value);"string"==typeof t&&(this.errorMsg=t,t=!1),this.error=!t}async submit(){if(await this.validate(),this.error)return this.color="red",this.fire(),void this.render();let t=this.value;this.value=""!==t?t:this.initial,this.done=!0,this.aborted=!1,this.error=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}up(){if(this.typed="",""===this.value&&(this.value=this.min-this.inc),this.value>=this.max)return this.bell();this.value+=this.inc,this.color="cyan",this.fire(),this.render()}down(){if(this.typed="",""===this.value&&(this.value=this.min+this.inc),this.value<=this.min)return this.bell();this.value-=this.inc,this.color="cyan",this.fire(),this.render()}delete(){let t=this.value.toString();if(0===t.length)return this.bell();this.value=this.parse(t=t.slice(0,-1))||"",""!==this.value&&this.value<this.min&&(this.value=this.min),this.color="cyan",this.fire(),this.render()}next(){this.value=this.initial,this.fire(),this.render()}_(t,e){if(!this.valid(t))return this.bell();const i=Date.now();if(i-this.lastHit>1e3&&(this.typed=""),this.typed+=t,this.lastHit=i,this.color="cyan","."===t)return this.fire();this.value=Math.min(this.parse(this.typed),this.max),this.value>this.max&&(this.value=this.max),this.value<this.min&&(this.value=this.min),this.fire(),this.render()}render(){this.closed||(this.firstRender||(this.outputError&&this.out.write(i.down(h(this.outputError,this.out.columns)-1)+o(this.outputError,this.out.columns)),this.out.write(o(this.outputText,this.out.columns))),super.render(),this.outputError="",this.outputText=[r.symbol(this.done,this.aborted),t.bold(this.msg),r.delimiter(this.done),this.done&&(this.done||this.placeholder)?this.rendered:t[this.color]().underline(this.rendered)].join(" "),this.error&&(this.outputError+=this.errorMsg.split("\n").reduce(((e,i,s)=>e+`\n${s?" ":n.pointerSmall} ${t.red().italic(i)}`),"")),this.out.write(s.line+i.to(0)+this.outputText+i.save+this.outputError+i.restore))}}}function Ei(){if(Ze)return ze;Ze=1;const t=Ct(),{cursor:e}=At(),i=fi(),{clear:s,figures:r,style:n,wrap:o,entriesToDisplay:h}=mi();return ze=class extends i{constructor(t={}){super(t),this.msg=t.message,this.cursor=t.cursor||0,this.scrollIndex=t.cursor||0,this.hint=t.hint||"",this.warn=t.warn||"- This option is disabled -",this.minSelected=t.min,this.showMinError=!1,this.maxChoices=t.max,this.instructions=t.instructions,this.optionsPerPage=t.optionsPerPage||10,this.value=t.choices.map(((t,e)=>("string"==typeof t&&(t={title:t,value:e}),{title:t&&(t.title||t.value||t),description:t&&t.description,value:t&&(void 0===t.value?e:t.value),selected:t&&t.selected,disabled:t&&t.disabled}))),this.clear=s("",this.out.columns),t.overrideRender||this.render()}reset(){this.value.map((t=>!t.selected)),this.cursor=0,this.fire(),this.render()}selected(){return this.value.filter((t=>t.selected))}exit(){this.abort()}abort(){this.done=this.aborted=!0,this.fire(),this.render(),this.out.write("\n"),this.close()}submit(){const t=this.value.filter((t=>t.selected));this.minSelected&&t.length<this.minSelected?(this.showMinError=!0,this.render()):(this.done=!0,this.aborted=!1,this.fire(),this.render(),this.out.write("\n"),this.close())}first(){this.cursor=0,this.render()}last(){this.cursor=this.value.length-1,this.render()}next(){this.cursor=(this.cursor+1)%this.value.length,this.render()}up(){0===this.cursor?this.cursor=this.value.length-1:this.cursor--,this.render()}down(){this.cursor===this.value.length-1?this.cursor=0:this.cursor++,this.render()}left(){this.value[this.cursor].selected=!1,this.render()}right(){if(this.value.filter((t=>t.selected)).length>=this.maxChoices)return this.bell();this.value[this.cursor].selected=!0,this.render()}handleSpaceToggle(){const t=this.value[this.cursor];if(t.selected)t.selected=!1,this.render();else{if(t.disabled||this.value.filter((t=>t.selected)).length>=this.maxChoices)return this.bell();t.selected=!0,this.render()}}toggleAll(){if(void 0!==this.maxChoices||this.value[this.cursor].disabled)return this.bell();const t=!this.value[this.cursor].selected;this.value.filter((t=>!t.disabled)).forEach((e=>e.selected=t)),this.render()}_(t,e){if(" "===t)this.handleSpaceToggle();else{if("a"!==t)return this.bell();this.toggleAll()}}renderInstructions(){return void 0===this.instructions||this.instructions?"string"==typeof this.instructions?this.instructions:`\nInstructions:\n    ${r.arrowUp}/${r.arrowDown}: Highlight option\n    ${r.arrowLeft}/${r.arrowRight}/[space]: Toggle selection\n`+(void 0===this.maxChoices?"    a: Toggle all\n":"")+"    enter/return: Complete answer":""}renderOption(e,i,s,n){const h=(i.selected?t.green(r.radioOn):r.radioOff)+" "+n+" ";let a,l;return i.disabled?a=e===s?t.gray().underline(i.title):t.strikethrough().gray(i.title):(a=e===s?t.cyan().underline(i.title):i.title,e===s&&i.description&&(l=` - ${i.description}`,(h.length+a.length+l.length>=this.out.columns||i.description.split(/\r?\n/).length>1)&&(l="\n"+o(i.description,{margin:h.length,width:this.out.columns})))),h+a+t.gray(l||"")}paginateOptions(e){if(0===e.length)return t.red("No matches for this query.");let i,{startIndex:s,endIndex:n}=h(this.cursor,e.length,this.optionsPerPage),o=[];for(let t=s;t<n;t++)i=t===s&&s>0?r.arrowUp:t===n-1&&n<e.length?r.arrowDown:" ",o.push(this.renderOption(this.cursor,e[t],t,i));return"\n"+o.join("\n")}renderOptions(t){return this.done?"":this.paginateOptions(t)}renderDoneOrInstructions(){if(this.done)return this.value.filter((t=>t.selected)).map((t=>t.title)).join(", ");const e=[t.gray(this.hint),this.renderInstructions()];return this.value[this.cursor].disabled&&e.push(t.yellow(this.warn)),e.join(" ")}render(){if(this.closed)return;this.firstRender&&this.out.write(e.hide),super.render();let i=[n.symbol(this.done,this.aborted),t.bold(this.msg),n.delimiter(!1),this.renderDoneOrInstructions()].join(" ");this.showMinError&&(i+=t.red(`You must select a minimum of ${this.minSelected} choices.`),this.showMinError=!1),i+=this.renderOptions(this.value),this.out.write(this.clear+i),this.clear=s(i,this.out.columns)}},ze}function Ti(){if(Qe)return Ke;Qe=1;const t=Ct(),e=fi(),{erase:i,cursor:s}=At(),{style:r,clear:n,figures:o,wrap:h,entriesToDisplay:a}=mi(),l=(t,e)=>t[e]&&(t[e].value||t[e].title||t[e]),u=(t,e)=>t[e]&&(t[e].title||t[e].value||t[e]);return Ke=class extends e{constructor(t={}){super(t),this.msg=t.message,this.suggest=t.suggest,this.choices=t.choices,this.initial="number"==typeof t.initial?t.initial:((t,e)=>{const i=t.findIndex((t=>t.value===e||t.title===e));return i>-1?i:void 0})(t.choices,t.initial),this.select=this.initial||t.cursor||0,this.i18n={noMatches:t.noMatches||"no matches found"},this.fallback=t.fallback||this.initial,this.clearFirst=t.clearFirst||!1,this.suggestions=[],this.input="",this.limit=t.limit||10,this.cursor=0,this.transform=r.render(t.style),this.scale=this.transform.scale,this.render=this.render.bind(this),this.complete=this.complete.bind(this),this.clear=n("",this.out.columns),this.complete(this.render),this.render()}set fallback(t){this._fb=Number.isSafeInteger(parseInt(t))?parseInt(t):t}get fallback(){let t;return"number"==typeof this._fb?t=this.choices[this._fb]:"string"==typeof this._fb&&(t={title:this._fb}),t||this._fb||{title:this.i18n.noMatches}}moveSelect(t){this.select=t,this.suggestions.length>0?this.value=l(this.suggestions,t):this.value=this.fallback.value,this.fire()}async complete(t){const e=this.completing=this.suggest(this.input,this.choices),i=await e;if(this.completing!==e)return;this.suggestions=i.map(((t,e,i)=>({title:u(i,e),value:l(i,e),description:t.description}))),this.completing=!1;const s=Math.max(i.length-1,0);this.moveSelect(Math.min(s,this.select)),t&&t()}reset(){this.input="",this.complete((()=>{this.moveSelect(void 0!==this.initial?this.initial:0),this.render()})),this.render()}exit(){this.clearFirst&&this.input.length>0?this.reset():(this.done=this.exited=!0,this.aborted=!1,this.fire(),this.render(),this.out.write("\n"),this.close())}abort(){this.done=this.aborted=!0,this.exited=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}submit(){this.done=!0,this.aborted=this.exited=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}_(t,e){let i=this.input.slice(0,this.cursor),s=this.input.slice(this.cursor);this.input=`${i}${t}${s}`,this.cursor=i.length+1,this.complete(this.render),this.render()}delete(){if(0===this.cursor)return this.bell();let t=this.input.slice(0,this.cursor-1),e=this.input.slice(this.cursor);this.input=`${t}${e}`,this.complete(this.render),this.cursor=this.cursor-1,this.render()}deleteForward(){if(this.cursor*this.scale>=this.rendered.length)return this.bell();let t=this.input.slice(0,this.cursor),e=this.input.slice(this.cursor+1);this.input=`${t}${e}`,this.complete(this.render),this.render()}first(){this.moveSelect(0),this.render()}last(){this.moveSelect(this.suggestions.length-1),this.render()}up(){0===this.select?this.moveSelect(this.suggestions.length-1):this.moveSelect(this.select-1),this.render()}down(){this.select===this.suggestions.length-1?this.moveSelect(0):this.moveSelect(this.select+1),this.render()}next(){this.select===this.suggestions.length-1?this.moveSelect(0):this.moveSelect(this.select+1),this.render()}nextPage(){this.moveSelect(Math.min(this.select+this.limit,this.suggestions.length-1)),this.render()}prevPage(){this.moveSelect(Math.max(this.select-this.limit,0)),this.render()}left(){if(this.cursor<=0)return this.bell();this.cursor=this.cursor-1,this.render()}right(){if(this.cursor*this.scale>=this.rendered.length)return this.bell();this.cursor=this.cursor+1,this.render()}renderOption(e,i,s,r){let n,a=s?o.arrowUp:r?o.arrowDown:" ",l=i?t.cyan().underline(e.title):e.title;return a=(i?t.cyan(o.pointer)+" ":"  ")+a,e.description&&(n=` - ${e.description}`,(a.length+l.length+n.length>=this.out.columns||e.description.split(/\r?\n/).length>1)&&(n="\n"+h(e.description,{margin:3,width:this.out.columns}))),a+" "+l+t.gray(n||"")}render(){if(this.closed)return;this.firstRender?this.out.write(s.hide):this.out.write(n(this.outputText,this.out.columns)),super.render();let{startIndex:e,endIndex:o}=a(this.select,this.choices.length,this.limit);if(this.outputText=[r.symbol(this.done,this.aborted,this.exited),t.bold(this.msg),r.delimiter(this.completing),this.done&&this.suggestions[this.select]?this.suggestions[this.select].title:this.rendered=this.transform.render(this.input)].join(" "),!this.done){const i=this.suggestions.slice(e,o).map(((t,i)=>this.renderOption(t,this.select===i+e,0===i&&e>0,i+e===o-1&&o<this.choices.length))).join("\n");this.outputText+="\n"+(i||t.gray(this.fallback.title))}this.out.write(i.line+s.to(0)+this.outputText)}}}function Pi(){if(ti)return Xe;ti=1;const t=Ct(),{cursor:e}=At(),i=Ei(),{clear:s,style:r,figures:n}=mi();return Xe=class extends i{constructor(t={}){t.overrideRender=!0,super(t),this.inputValue="",this.clear=s("",this.out.columns),this.filteredOptions=this.value,this.render()}last(){this.cursor=this.filteredOptions.length-1,this.render()}next(){this.cursor=(this.cursor+1)%this.filteredOptions.length,this.render()}up(){0===this.cursor?this.cursor=this.filteredOptions.length-1:this.cursor--,this.render()}down(){this.cursor===this.filteredOptions.length-1?this.cursor=0:this.cursor++,this.render()}left(){this.filteredOptions[this.cursor].selected=!1,this.render()}right(){if(this.value.filter((t=>t.selected)).length>=this.maxChoices)return this.bell();this.filteredOptions[this.cursor].selected=!0,this.render()}delete(){this.inputValue.length&&(this.inputValue=this.inputValue.substr(0,this.inputValue.length-1),this.updateFilteredOptions())}updateFilteredOptions(){const t=this.filteredOptions[this.cursor];this.filteredOptions=this.value.filter((t=>!this.inputValue||(!("string"!=typeof t.title||!t.title.toLowerCase().includes(this.inputValue.toLowerCase()))||!("string"!=typeof t.value||!t.value.toLowerCase().includes(this.inputValue.toLowerCase())))));const e=this.filteredOptions.findIndex((e=>e===t));this.cursor=e<0?0:e,this.render()}handleSpaceToggle(){const t=this.filteredOptions[this.cursor];if(t.selected)t.selected=!1,this.render();else{if(t.disabled||this.value.filter((t=>t.selected)).length>=this.maxChoices)return this.bell();t.selected=!0,this.render()}}handleInputChange(t){this.inputValue=this.inputValue+t,this.updateFilteredOptions()}_(t,e){" "===t?this.handleSpaceToggle():this.handleInputChange(t)}renderInstructions(){return void 0===this.instructions||this.instructions?"string"==typeof this.instructions?this.instructions:`\nInstructions:\n    ${n.arrowUp}/${n.arrowDown}: Highlight option\n    ${n.arrowLeft}/${n.arrowRight}/[space]: Toggle selection\n    [a,b,c]/delete: Filter choices\n    enter/return: Complete answer\n`:""}renderCurrentInput(){return`\nFiltered results for: ${this.inputValue?this.inputValue:t.gray("Enter something to filter")}\n`}renderOption(e,i,s){let r;return r=i.disabled?e===s?t.gray().underline(i.title):t.strikethrough().gray(i.title):e===s?t.cyan().underline(i.title):i.title,(i.selected?t.green(n.radioOn):n.radioOff)+"  "+r}renderDoneOrInstructions(){if(this.done)return this.value.filter((t=>t.selected)).map((t=>t.title)).join(", ");const e=[t.gray(this.hint),this.renderInstructions(),this.renderCurrentInput()];return this.filteredOptions.length&&this.filteredOptions[this.cursor].disabled&&e.push(t.yellow(this.warn)),e.join(" ")}render(){if(this.closed)return;this.firstRender&&this.out.write(e.hide),super.render();let i=[r.symbol(this.done,this.aborted),t.bold(this.msg),r.delimiter(!1),this.renderDoneOrInstructions()].join(" ");this.showMinError&&(i+=t.red(`You must select a minimum of ${this.minSelected} choices.`),this.showMinError=!1),i+=this.renderOptions(this.filteredOptions),this.out.write(this.clear+i),this.clear=s(i,this.out.columns)}},Xe}function ji(){if(ii)return ei;ii=1;const t=Ct(),e=fi(),{style:i,clear:s}=mi(),{erase:r,cursor:n}=At();return ei=class extends e{constructor(t={}){super(t),this.msg=t.message,this.value=t.initial,this.initialValue=!!t.initial,this.yesMsg=t.yes||"yes",this.yesOption=t.yesOption||"(Y/n)",this.noMsg=t.no||"no",this.noOption=t.noOption||"(y/N)",this.render()}reset(){this.value=this.initialValue,this.fire(),this.render()}exit(){this.abort()}abort(){this.done=this.aborted=!0,this.fire(),this.render(),this.out.write("\n"),this.close()}submit(){this.value=this.value||!1,this.done=!0,this.aborted=!1,this.fire(),this.render(),this.out.write("\n"),this.close()}_(t,e){return"y"===t.toLowerCase()?(this.value=!0,this.submit()):"n"===t.toLowerCase()?(this.value=!1,this.submit()):this.bell()}render(){this.closed||(this.firstRender?this.out.write(n.hide):this.out.write(s(this.outputText,this.out.columns)),super.render(),this.outputText=[i.symbol(this.done,this.aborted),t.bold(this.msg),i.delimiter(this.done),this.done?this.value?this.yesMsg:this.noMsg:t.gray(this.initialValue?this.yesOption:this.noOption)].join(" "),this.out.write(r.line+n.to(0)+this.outputText))}}}function Ii(){return ni||(ni=1,function(t){const e=ai,i=ri?si:(ri=1,si={TextPrompt:gi(),SelectPrompt:vi(),TogglePrompt:bi(),DatePrompt:Mi(),NumberPrompt:ki(),MultiselectPrompt:Ei(),AutocompletePrompt:Ti(),AutocompleteMultiselectPrompt:Pi(),ConfirmPrompt:ji()}),s=t=>t;function r(t,e,r={}){return new Promise(((n,o)=>{const h=new i[t](e),a=r.onAbort||s,l=r.onSubmit||s,u=r.onExit||s;h.on("state",e.onState||s),h.on("submit",(t=>n(l(t)))),h.on("exit",(t=>n(u(t)))),h.on("abort",(t=>o(a(t))))}))}e.text=t=>r("TextPrompt",t),e.password=t=>(t.style="password",e.text(t)),e.invisible=t=>(t.style="invisible",e.text(t)),e.number=t=>r("NumberPrompt",t),e.date=t=>r("DatePrompt",t),e.confirm=t=>r("ConfirmPrompt",t),e.list=t=>{const e=t.separator||",";return r("TextPrompt",t,{onSubmit:t=>t.split(e).map((t=>t.trim()))})},e.toggle=t=>r("TogglePrompt",t),e.select=t=>r("SelectPrompt",t),e.multiselect=t=>{t.choices=[].concat(t.choices||[]);const e=t=>t.filter((t=>t.selected)).map((t=>t.value));return r("MultiselectPrompt",t,{onAbort:e,onSubmit:e})},e.autocompleteMultiselect=t=>{t.choices=[].concat(t.choices||[]);const e=t=>t.filter((t=>t.selected)).map((t=>t.value));return r("AutocompleteMultiselectPrompt",t,{onAbort:e,onSubmit:e})};const n=(t,e)=>Promise.resolve(e.filter((e=>e.title.slice(0,t.length).toLowerCase()===t.toLowerCase())));e.autocomplete=t=>(t.suggest=t.suggest||n,t.choices=[].concat(t.choices||[]),r("AutocompletePrompt",t))}()),ai}var Di=function(t){t=(Array.isArray(t)?t:t.split(".")).map(Number);let e=0,i=process.versions.node.split(".").map(Number);for(;e<t.length;e++){if(i[e]>t[e])return!1;if(t[e]>i[e])return!0}return!1}("8.6.0")?function(){if(Ot)return xt;function t(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function e(e){for(var s=1;s<arguments.length;s++){var r=null!=arguments[s]?arguments[s]:{};s%2?t(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function s(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return r(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var s=0,n=function(){};return{s:n,n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,h=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return h=t.done,t},e:function(t){a=!0,o=t},f:function(){try{h||null==i.return||i.return()}finally{if(a)throw o}}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,s=new Array(e);i<e;i++)s[i]=t[i];return s}function n(t,e,i,s,r,n,o){try{var h=t[n](o),a=h.value}catch(t){return void i(t)}h.done?e(a):Promise.resolve(a).then(s,r)}function o(t){return function(){var e=this,i=arguments;return new Promise((function(s,r){var o=t.apply(e,i);function h(t){n(o,s,r,h,a,"next",t)}function a(t){n(o,s,r,h,a,"throw",t)}h(void 0)}))}}Ot=1;const h=Qt(),a=["suggest","format","onState","validate","onRender","type"],l=()=>{};function u(){return c.apply(this,arguments)}function c(){return c=o((function*(t=[],{onSubmit:i=l,onCancel:r=l}={}){const n={},c=u._override||{};let p,m,f,g,v,b;t=[].concat(t);const y=function(){var t=o((function*(t,e,i=!1){if(i||!t.validate||!0===t.validate(e))return t.format?yield t.format(e,n):e}));return function(e,i){return t.apply(this,arguments)}}();var w,_=s(t);try{for(_.s();!(w=_.n()).done;){m=w.value;var x=m;if(g=x.name,v=x.type,"function"==typeof v&&(v=yield v(p,e({},n),m),m.type=v),v){for(let t in m){if(a.includes(t))continue;let i=m[t];m[t]="function"==typeof i?yield i(p,e({},n),b):i}if(b=m,"string"!=typeof m.message)throw new Error("prompt message is required");var O=m;if(g=O.name,v=O.type,void 0===h[v])throw new Error(`prompt type (${v}) is not defined`);if(void 0===c[m.name]||(p=yield y(m,c[m.name]),void 0===p)){try{p=u._injected?d(u._injected,m.initial):yield h[v](m),n[g]=p=yield y(m,p,!0),f=yield i(m,p,n)}catch(t){f=!(yield r(m,n))}if(f)return n}else n[g]=p}}}catch(t){_.e(t)}finally{_.f()}return n})),c.apply(this,arguments)}function d(t,e){const i=t.shift();if(i instanceof Error)throw i;return void 0===i?e:i}return xt=Object.assign(u,{prompt:u,prompts:h,inject:function(t){u._injected=(u._injected||[]).concat(t)},override:function(t){u._override=Object.assign({},t)}})}():function(){if(hi)return oi;hi=1;const t=Ii(),e=["suggest","format","onState","validate","onRender","type"],i=()=>{};async function s(n=[],{onSubmit:o=i,onCancel:h=i}={}){const a={},l=s._override||{};let u,c,d,p,m,f;n=[].concat(n);const g=async(t,e,i=!1)=>{if(i||!t.validate||!0===t.validate(e))return t.format?await t.format(e,a):e};for(c of n)if(({name:p,type:m}=c),"function"==typeof m&&(m=await m(u,{...a},c),c.type=m),m){for(let t in c){if(e.includes(t))continue;let i=c[t];c[t]="function"==typeof i?await i(u,{...a},f):i}if(f=c,"string"!=typeof c.message)throw new Error("prompt message is required");if(({name:p,type:m}=c),void 0===t[m])throw new Error(`prompt type (${m}) is not defined`);if(void 0===l[c.name]||(u=await g(c,l[c.name]),void 0===u)){try{u=s._injected?r(s._injected,c.initial):await t[m](c),a[p]=u=await g(c,u,!0),d=await o(c,u,a)}catch(t){d=!await h(c,a)}if(d)return a}else a[p]=u}return a}function r(t,e){const i=t.shift();if(i instanceof Error)throw i;return void 0===i?e:i}return oi=Object.assign(s,{prompt:s,prompts:t,inject:function(t){s._injected=(s._injected||[]).concat(t)},override:function(t){s._override=Object.assign({},t)}})}(),Hi=u(Di);function Vi(t){return"object"==typeof t?JSON.stringify(t):t}function Fi(t){t.body&&(t.body=Vi(t.body)),$done({response:{...t}})}function Ri(t,e,i){t=Vi(t),e=Vi(e),i=Vi(i),$notification.post(t,e,i)}const Ni=["get","put","delete","head","options","patch","post"],Li={};for(const t of Ni)Li[t]=(e,i)=>{$httpClient[t](e,i)};const Yi={lemonSqueezy:{base:"https://api.lemonsqueezy.com/v1/licenses",activate:function(){Fi({body:{activated:!0,instance:{id:"wibus-wee"},error:null}})},validate:function(){Fi({body:{valid:!0,error:null}})}},paddle:{base:"https://v3.paddleapi.com/3.2/license",activate:function(){const t=$request.body;if(!t)return void Fi({body:{success:!1,response:{error:"[Surge] Activator: No body found"}}});const e=t.split("&");let i="";for(const t of e)t.includes("product_id")&&(i=t.split("=")[1]);Fi({body:{success:!0,response:{product_id:i,activation_id:"QiuChenly",type:"personal",expires:1,expiry_date:1999999999999}}})},validate:{base:"verify",func:function(){Fi({body:{success:!0,response:{type:"personal",expires:1,expiry_date:1999999999999}}})}}},spotify:{base:["https://audio-akp-quic-spotify-com.akamaized.net","https://audio-fa.scdn.co","https://creativeservice-production.scdn.co","https://audio4-fa.scdn.co"],customs:[{base:"*",func:function(){Ri("Spotify Remove Ads","请求 MP3",""),Li.get({url:"https://raw.githubusercontent.com/texnikru/blank-mp3s/master/1sec.mp3"},((t,e,i)=>{if(t)return Ri("Spotify Remove Ads","MP3 请求失败",t),Fi({status:500,body:t});Fi({status:e.status,headers:e.headers,body:i})}))}}]},gumroad:{base:"https://api.gumroad.com/v2/licenses",validate:{base:"verify",func:function(){const t=function(t){const e=new URL(t).searchParams,i={};for(const[t,s]of e)i[t]=s;return i}($request.url);return Fi({headers:{"Content-Type":"application/json; charset=utf-8"},body:{success:!0,uses:-999,purchase:{sellerId:"123",productId:t.product_permalink,productName:t.product_permalink,permalink:t.product_permalink,productPermalink:t.product_permalink,email:"qiuchenly@outlook.com",price:100,gumroadFee:0,currency:"usd",quantity:1,discoverFeeCharged:!1,canContact:!1,referrer:"none",orderNumber:1234,saleId:"1",saleTimestamp:"2099-07-16T19:00:00Z",licenseKey:t.license_key,refunded:!1,disputed:!1,disputeWon:!1,id:"1234",createdAt:"2023-07-16T19:00:00Z"}}})}}},raycast:{base:"https://backend.raycast.com/api/v1",activate:{base:"*",func:()=>{if($request.headers["x-raycast-unblock"])return console.log("Raycast Unblock request"),void $done({headers:{...$request.headers,"x-raycast-unblock":void 0}});$done({url:$request.url.replace("https://backend.raycast.com","http://127.0.0.1:3000"),headers:$request.headers,body:$request.body})}},customs:[]}};var qi={exports:{}},Ui={},Wi={};let Gi=class extends Error{constructor(t,e,i){super(i),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=e,this.exitCode=t,this.nestedError=void 0}};Wi.CommanderError=Gi,Wi.InvalidArgumentError=class extends Gi{constructor(t){super(1,"commander.invalidArgument",t),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}};const{InvalidArgumentError:Bi}=Wi;Ui.Argument=class{constructor(t,e){switch(this.description=e||"",this.variadic=!1,this.parseArg=void 0,this.defaultValue=void 0,this.defaultValueDescription=void 0,this.argChoices=void 0,t[0]){case"<":this.required=!0,this._name=t.slice(1,-1);break;case"[":this.required=!1,this._name=t.slice(1,-1);break;default:this.required=!0,this._name=t}this._name.length>3&&"..."===this._name.slice(-3)&&(this.variadic=!0,this._name=this._name.slice(0,-3))}name(){return this._name}_concatValue(t,e){return e!==this.defaultValue&&Array.isArray(e)?e.concat(t):[t]}default(t,e){return this.defaultValue=t,this.defaultValueDescription=e,this}argParser(t){return this.parseArg=t,this}choices(t){return this.argChoices=t.slice(),this.parseArg=(t,e)=>{if(!this.argChoices.includes(t))throw new Bi(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._concatValue(t,e):t},this}argRequired(){return this.required=!0,this}argOptional(){return this.required=!1,this}},Ui.humanReadableArgName=function(t){const e=t.name()+(!0===t.variadic?"...":"");return t.required?"<"+e+">":"["+e+"]"};var Ji={},zi={};const{humanReadableArgName:Zi}=Ui;zi.Help=class{constructor(){this.helpWidth=void 0,this.sortSubcommands=!1,this.sortOptions=!1,this.showGlobalOptions=!1}visibleCommands(t){const e=t.commands.filter((t=>!t._hidden));if(t._hasImplicitHelpCommand()){const[,i,s]=t._helpCommandnameAndArgs.match(/([^ ]+) *(.*)/),r=t.createCommand(i).helpOption(!1);r.description(t._helpCommandDescription),s&&r.arguments(s),e.push(r)}return this.sortSubcommands&&e.sort(((t,e)=>t.name().localeCompare(e.name()))),e}compareOptions(t,e){const i=t=>t.short?t.short.replace(/^-/,""):t.long.replace(/^--/,"");return i(t).localeCompare(i(e))}visibleOptions(t){const e=t.options.filter((t=>!t.hidden)),i=t._hasHelpOption&&t._helpShortFlag&&!t._findOption(t._helpShortFlag),s=t._hasHelpOption&&!t._findOption(t._helpLongFlag);if(i||s){let r;r=i?s?t.createOption(t._helpFlags,t._helpDescription):t.createOption(t._helpShortFlag,t._helpDescription):t.createOption(t._helpLongFlag,t._helpDescription),e.push(r)}return this.sortOptions&&e.sort(this.compareOptions),e}visibleGlobalOptions(t){if(!this.showGlobalOptions)return[];const e=[];for(let i=t.parent;i;i=i.parent){const t=i.options.filter((t=>!t.hidden));e.push(...t)}return this.sortOptions&&e.sort(this.compareOptions),e}visibleArguments(t){return t._argsDescription&&t._args.forEach((e=>{e.description=e.description||t._argsDescription[e.name()]||""})),t._args.find((t=>t.description))?t._args:[]}subcommandTerm(t){const e=t._args.map((t=>Zi(t))).join(" ");return t._name+(t._aliases[0]?"|"+t._aliases[0]:"")+(t.options.length?" [options]":"")+(e?" "+e:"")}optionTerm(t){return t.flags}argumentTerm(t){return t.name()}longestSubcommandTermLength(t,e){return e.visibleCommands(t).reduce(((t,i)=>Math.max(t,e.subcommandTerm(i).length)),0)}longestOptionTermLength(t,e){return e.visibleOptions(t).reduce(((t,i)=>Math.max(t,e.optionTerm(i).length)),0)}longestGlobalOptionTermLength(t,e){return e.visibleGlobalOptions(t).reduce(((t,i)=>Math.max(t,e.optionTerm(i).length)),0)}longestArgumentTermLength(t,e){return e.visibleArguments(t).reduce(((t,i)=>Math.max(t,e.argumentTerm(i).length)),0)}commandUsage(t){let e=t._name;t._aliases[0]&&(e=e+"|"+t._aliases[0]);let i="";for(let e=t.parent;e;e=e.parent)i=e.name()+" "+i;return i+e+" "+t.usage()}commandDescription(t){return t.description()}subcommandDescription(t){return t.summary()||t.description()}optionDescription(t){const e=[];if(t.argChoices&&e.push(`choices: ${t.argChoices.map((t=>JSON.stringify(t))).join(", ")}`),void 0!==t.defaultValue){(t.required||t.optional||t.isBoolean()&&"boolean"==typeof t.defaultValue)&&e.push(`default: ${t.defaultValueDescription||JSON.stringify(t.defaultValue)}`)}return void 0!==t.presetArg&&t.optional&&e.push(`preset: ${JSON.stringify(t.presetArg)}`),void 0!==t.envVar&&e.push(`env: ${t.envVar}`),e.length>0?`${t.description} (${e.join(", ")})`:t.description}argumentDescription(t){const e=[];if(t.argChoices&&e.push(`choices: ${t.argChoices.map((t=>JSON.stringify(t))).join(", ")}`),void 0!==t.defaultValue&&e.push(`default: ${t.defaultValueDescription||JSON.stringify(t.defaultValue)}`),e.length>0){const i=`(${e.join(", ")})`;return t.description?`${t.description} ${i}`:i}return t.description}formatHelp(t,e){const i=e.padWidth(t,e),s=e.helpWidth||80;function r(t,r){if(r){const n=`${t.padEnd(i+2)}${r}`;return e.wrap(n,s-2,i+2)}return t}function n(t){return t.join("\n").replace(/^/gm," ".repeat(2))}let o=[`Usage: ${e.commandUsage(t)}`,""];const h=e.commandDescription(t);h.length>0&&(o=o.concat([e.wrap(h,s,0),""]));const a=e.visibleArguments(t).map((t=>r(e.argumentTerm(t),e.argumentDescription(t))));a.length>0&&(o=o.concat(["Arguments:",n(a),""]));const l=e.visibleOptions(t).map((t=>r(e.optionTerm(t),e.optionDescription(t))));if(l.length>0&&(o=o.concat(["Options:",n(l),""])),this.showGlobalOptions){const i=e.visibleGlobalOptions(t).map((t=>r(e.optionTerm(t),e.optionDescription(t))));i.length>0&&(o=o.concat(["Global Options:",n(i),""]))}const u=e.visibleCommands(t).map((t=>r(e.subcommandTerm(t),e.subcommandDescription(t))));return u.length>0&&(o=o.concat(["Commands:",n(u),""])),o.join("\n")}padWidth(t,e){return Math.max(e.longestOptionTermLength(t,e),e.longestGlobalOptionTermLength(t,e),e.longestSubcommandTermLength(t,e),e.longestArgumentTermLength(t,e))}wrap(t,e,i,s=40){const r=new RegExp("[\\n][ \\f\\t\\v   -   　\ufeff]+");if(t.match(r))return t;const n=e-i;if(n<s)return t;const o=t.slice(0,i),h=t.slice(i).replace("\r\n","\n"),a=" ".repeat(i),l="\\s​",u=new RegExp(`\n|.{1,${n-1}}([${l}]|$)|[^${l}]+?([${l}]|$)`,"g");return o+(h.match(u)||[]).map(((t,e)=>"\n"===t?"":(e>0?a:"")+t.trimEnd())).join("\n")}};var Ki={};const{InvalidArgumentError:Qi}=Wi;function Xi(t){let e,i;const s=t.split(/[ |,]+/);return s.length>1&&!/^[[<]/.test(s[1])&&(e=s.shift()),i=s.shift(),!e&&/^-[^-]$/.test(i)&&(e=i,i=void 0),{shortFlag:e,longFlag:i}}Ki.Option=class{constructor(t,e){this.flags=t,this.description=e||"",this.required=t.includes("<"),this.optional=t.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test(t),this.mandatory=!1;const i=Xi(t);this.short=i.shortFlag,this.long=i.longFlag,this.negate=!1,this.long&&(this.negate=this.long.startsWith("--no-")),this.defaultValue=void 0,this.defaultValueDescription=void 0,this.presetArg=void 0,this.envVar=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0,this.conflictsWith=[],this.implied=void 0}default(t,e){return this.defaultValue=t,this.defaultValueDescription=e,this}preset(t){return this.presetArg=t,this}conflicts(t){return this.conflictsWith=this.conflictsWith.concat(t),this}implies(t){let e=t;return"string"==typeof t&&(e={[t]:!0}),this.implied=Object.assign(this.implied||{},e),this}env(t){return this.envVar=t,this}argParser(t){return this.parseArg=t,this}makeOptionMandatory(t=!0){return this.mandatory=!!t,this}hideHelp(t=!0){return this.hidden=!!t,this}_concatValue(t,e){return e!==this.defaultValue&&Array.isArray(e)?e.concat(t):[t]}choices(t){return this.argChoices=t.slice(),this.parseArg=(t,e)=>{if(!this.argChoices.includes(t))throw new Qi(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._concatValue(t,e):t},this}name(){return this.long?this.long.replace(/^--/,""):this.short.replace(/^-/,"")}attributeName(){return this.name().replace(/^no-/,"").split("-").reduce(((t,e)=>t+e[0].toUpperCase()+e.slice(1)))}is(t){return this.short===t||this.long===t}isBoolean(){return!this.required&&!this.optional&&!this.negate}},Ki.splitOptionFlags=Xi,Ki.DualOptions=class{constructor(t){this.positiveOptions=new Map,this.negativeOptions=new Map,this.dualOptions=new Set,t.forEach((t=>{t.negate?this.negativeOptions.set(t.attributeName(),t):this.positiveOptions.set(t.attributeName(),t)})),this.negativeOptions.forEach(((t,e)=>{this.positiveOptions.has(e)&&this.dualOptions.add(e)}))}valueFromOption(t,e){const i=e.attributeName();if(!this.dualOptions.has(i))return!0;const s=this.negativeOptions.get(i).presetArg,r=void 0!==s&&s;return e.negate===(r===t)}};var ts={};const es=3;ts.suggestSimilar=function(t,e){if(!e||0===e.length)return"";e=Array.from(new Set(e));const i=t.startsWith("--");i&&(t=t.slice(2),e=e.map((t=>t.slice(2))));let s=[],r=es;return e.forEach((e=>{if(e.length<=1)return;const i=function(t,e){if(Math.abs(t.length-e.length)>es)return Math.max(t.length,e.length);const i=[];for(let e=0;e<=t.length;e++)i[e]=[e];for(let t=0;t<=e.length;t++)i[0][t]=t;for(let s=1;s<=e.length;s++)for(let r=1;r<=t.length;r++){let n=1;n=t[r-1]===e[s-1]?0:1,i[r][s]=Math.min(i[r-1][s]+1,i[r][s-1]+1,i[r-1][s-1]+n),r>1&&s>1&&t[r-1]===e[s-2]&&t[r-2]===e[s-1]&&(i[r][s]=Math.min(i[r][s],i[r-2][s-2]+1))}return i[t.length][e.length]}(t,e),n=Math.max(t.length,e.length);(n-i)/n>.4&&(i<r?(r=i,s=[e]):i===r&&s.push(e))})),s.sort(((t,e)=>t.localeCompare(e))),i&&(s=s.map((t=>`--${t}`))),s.length>1?`\n(Did you mean one of ${s.join(", ")}?)`:1===s.length?`\n(Did you mean ${s[0]}?)`:""};const is=r.EventEmitter,ss=n,rs=o,ns=h,os=a,{Argument:hs,humanReadableArgName:as}=Ui,{CommanderError:ls}=Wi,{Help:us}=zi,{Option:cs,splitOptionFlags:ds,DualOptions:ps}=Ki,{suggestSimilar:ms}=ts;function fs(t,e){t._hasHelpOption&&e.find((e=>e===t._helpLongFlag||e===t._helpShortFlag))&&(t.outputHelp(),t._exit(0,"commander.helpDisplayed","(outputHelp)"))}function gs(t){return t.map((t=>{if(!t.startsWith("--inspect"))return t;let e,i,s="127.0.0.1",r="9229";return null!==(i=t.match(/^(--inspect(-brk)?)$/))?e=i[1]:null!==(i=t.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))?(e=i[1],/^\d+$/.test(i[3])?r=i[3]:s=i[3]):null!==(i=t.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))&&(e=i[1],s=i[3],r=i[4]),e&&"0"!==r?`${e}=${s}:${parseInt(r)+1}`:t}))}function vs(t){const e=[];for(let i=t;i;i=i.parent)e.push(i);return e}Ji.Command=class t extends is{constructor(t){super(),this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!0,this._args=[],this.args=[],this.rawArgs=[],this.processedArgs=[],this._scriptPath=null,this._name=t||"",this._optionValues={},this._optionValueSources={},this._storeOptionsAsProperties=!1,this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._executableDir=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._summary="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._lifeCycleHooks={},this._showHelpAfterError=!1,this._showSuggestionAfterError=!0,this._outputConfiguration={writeOut:t=>os.stdout.write(t),writeErr:t=>os.stderr.write(t),getOutHelpWidth:()=>os.stdout.isTTY?os.stdout.columns:void 0,getErrHelpWidth:()=>os.stderr.isTTY?os.stderr.columns:void 0,outputError:(t,e)=>e(t)},this._hidden=!1,this._hasHelpOption=!0,this._helpFlags="-h, --help",this._helpDescription="display help for command",this._helpShortFlag="-h",this._helpLongFlag="--help",this._addImplicitHelpCommand=void 0,this._helpCommandName="help",this._helpCommandnameAndArgs="help [command]",this._helpCommandDescription="display help for command",this._helpConfiguration={}}copyInheritedSettings(t){return this._outputConfiguration=t._outputConfiguration,this._hasHelpOption=t._hasHelpOption,this._helpFlags=t._helpFlags,this._helpDescription=t._helpDescription,this._helpShortFlag=t._helpShortFlag,this._helpLongFlag=t._helpLongFlag,this._helpCommandName=t._helpCommandName,this._helpCommandnameAndArgs=t._helpCommandnameAndArgs,this._helpCommandDescription=t._helpCommandDescription,this._helpConfiguration=t._helpConfiguration,this._exitCallback=t._exitCallback,this._storeOptionsAsProperties=t._storeOptionsAsProperties,this._combineFlagAndOptionalValue=t._combineFlagAndOptionalValue,this._allowExcessArguments=t._allowExcessArguments,this._enablePositionalOptions=t._enablePositionalOptions,this._showHelpAfterError=t._showHelpAfterError,this._showSuggestionAfterError=t._showSuggestionAfterError,this}command(t,e,i){let s=e,r=i;"object"==typeof s&&null!==s&&(r=s,s=null),r=r||{};const[,n,o]=t.match(/([^ ]+) *(.*)/),h=this.createCommand(n);return s&&(h.description(s),h._executableHandler=!0),r.isDefault&&(this._defaultCommandName=h._name),h._hidden=!(!r.noHelp&&!r.hidden),h._executableFile=r.executableFile||null,o&&h.arguments(o),this.commands.push(h),h.parent=this,h.copyInheritedSettings(this),s?this:h}createCommand(e){return new t(e)}createHelp(){return Object.assign(new us,this.configureHelp())}configureHelp(t){return void 0===t?this._helpConfiguration:(this._helpConfiguration=t,this)}configureOutput(t){return void 0===t?this._outputConfiguration:(Object.assign(this._outputConfiguration,t),this)}showHelpAfterError(t=!0){return"string"!=typeof t&&(t=!!t),this._showHelpAfterError=t,this}showSuggestionAfterError(t=!0){return this._showSuggestionAfterError=!!t,this}addCommand(t,e){if(!t._name)throw new Error("Command passed to .addCommand() must have a name\n- specify the name in Command constructor or using .name()");return(e=e||{}).isDefault&&(this._defaultCommandName=t._name),(e.noHelp||e.hidden)&&(t._hidden=!0),this.commands.push(t),t.parent=this,this}createArgument(t,e){return new hs(t,e)}argument(t,e,i,s){const r=this.createArgument(t,e);return"function"==typeof i?r.default(s).argParser(i):r.default(i),this.addArgument(r),this}arguments(t){return t.trim().split(/ +/).forEach((t=>{this.argument(t)})),this}addArgument(t){const e=this._args.slice(-1)[0];if(e&&e.variadic)throw new Error(`only the last argument can be variadic '${e.name()}'`);if(t.required&&void 0!==t.defaultValue&&void 0===t.parseArg)throw new Error(`a default value for a required argument is never used: '${t.name()}'`);return this._args.push(t),this}addHelpCommand(t,e){return!1===t?this._addImplicitHelpCommand=!1:(this._addImplicitHelpCommand=!0,"string"==typeof t&&(this._helpCommandName=t.split(" ")[0],this._helpCommandnameAndArgs=t),this._helpCommandDescription=e||this._helpCommandDescription),this}_hasImplicitHelpCommand(){return void 0===this._addImplicitHelpCommand?this.commands.length&&!this._actionHandler&&!this._findCommand("help"):this._addImplicitHelpCommand}hook(t,e){const i=["preSubcommand","preAction","postAction"];if(!i.includes(t))throw new Error(`Unexpected value for event passed to hook : '${t}'.\nExpecting one of '${i.join("', '")}'`);return this._lifeCycleHooks[t]?this._lifeCycleHooks[t].push(e):this._lifeCycleHooks[t]=[e],this}exitOverride(t){return this._exitCallback=t||(t=>{if("commander.executeSubCommandAsync"!==t.code)throw t}),this}_exit(t,e,i){this._exitCallback&&this._exitCallback(new ls(t,e,i)),os.exit(t)}action(t){return this._actionHandler=e=>{const i=this._args.length,s=e.slice(0,i);return this._storeOptionsAsProperties?s[i]=this:s[i]=this.opts(),s.push(this),t.apply(this,s)},this}createOption(t,e){return new cs(t,e)}addOption(t){const e=t.name(),i=t.attributeName();if(t.negate){const e=t.long.replace(/^--no-/,"--");this._findOption(e)||this.setOptionValueWithSource(i,void 0===t.defaultValue||t.defaultValue,"default")}else void 0!==t.defaultValue&&this.setOptionValueWithSource(i,t.defaultValue,"default");this.options.push(t);const s=(e,s,r)=>{null==e&&void 0!==t.presetArg&&(e=t.presetArg);const n=this.getOptionValue(i);if(null!==e&&t.parseArg)try{e=t.parseArg(e,n)}catch(t){if("commander.invalidArgument"===t.code){const e=`${s} ${t.message}`;this.error(e,{exitCode:t.exitCode,code:t.code})}throw t}else null!==e&&t.variadic&&(e=t._concatValue(e,n));null==e&&(e=!t.negate&&(!(!t.isBoolean()&&!t.optional)||"")),this.setOptionValueWithSource(i,e,r)};return this.on("option:"+e,(e=>{const i=`error: option '${t.flags}' argument '${e}' is invalid.`;s(e,i,"cli")})),t.envVar&&this.on("optionEnv:"+e,(e=>{const i=`error: option '${t.flags}' value '${e}' from env '${t.envVar}' is invalid.`;s(e,i,"env")})),this}_optionEx(t,e,i,s,r){if("object"==typeof e&&e instanceof cs)throw new Error("To add an Option object use addOption() instead of option() or requiredOption()");const n=this.createOption(e,i);if(n.makeOptionMandatory(!!t.mandatory),"function"==typeof s)n.default(r).argParser(s);else if(s instanceof RegExp){const t=s;s=(e,i)=>{const s=t.exec(e);return s?s[0]:i},n.default(r).argParser(s)}else n.default(s);return this.addOption(n)}option(t,e,i,s){return this._optionEx({},t,e,i,s)}requiredOption(t,e,i,s){return this._optionEx({mandatory:!0},t,e,i,s)}combineFlagAndOptionalValue(t=!0){return this._combineFlagAndOptionalValue=!!t,this}allowUnknownOption(t=!0){return this._allowUnknownOption=!!t,this}allowExcessArguments(t=!0){return this._allowExcessArguments=!!t,this}enablePositionalOptions(t=!0){return this._enablePositionalOptions=!!t,this}passThroughOptions(t=!0){if(this._passThroughOptions=!!t,this.parent&&t&&!this.parent._enablePositionalOptions)throw new Error("passThroughOptions can not be used without turning on enablePositionalOptions for parent command(s)");return this}storeOptionsAsProperties(t=!0){if(this._storeOptionsAsProperties=!!t,this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");return this}getOptionValue(t){return this._storeOptionsAsProperties?this[t]:this._optionValues[t]}setOptionValue(t,e){return this.setOptionValueWithSource(t,e,void 0)}setOptionValueWithSource(t,e,i){return this._storeOptionsAsProperties?this[t]=e:this._optionValues[t]=e,this._optionValueSources[t]=i,this}getOptionValueSource(t){return this._optionValueSources[t]}getOptionValueSourceWithGlobals(t){let e;return vs(this).forEach((i=>{void 0!==i.getOptionValueSource(t)&&(e=i.getOptionValueSource(t))})),e}_prepareUserArgs(t,e){if(void 0!==t&&!Array.isArray(t))throw new Error("first parameter to parse must be array or undefined");let i;switch(e=e||{},void 0===t&&(t=os.argv,os.versions&&os.versions.electron&&(e.from="electron")),this.rawArgs=t.slice(),e.from){case void 0:case"node":this._scriptPath=t[1],i=t.slice(2);break;case"electron":os.defaultApp?(this._scriptPath=t[1],i=t.slice(2)):i=t.slice(1);break;case"user":i=t.slice(0);break;default:throw new Error(`unexpected parse option { from: '${e.from}' }`)}return!this._name&&this._scriptPath&&this.nameFromFilename(this._scriptPath),this._name=this._name||"program",i}parse(t,e){const i=this._prepareUserArgs(t,e);return this._parseCommand([],i),this}async parseAsync(t,e){const i=this._prepareUserArgs(t,e);return await this._parseCommand([],i),this}_executeSubCommand(t,e){e=e.slice();let i=!1;const s=[".js",".ts",".tsx",".mjs",".cjs"];function r(t,e){const i=rs.resolve(t,e);if(ns.existsSync(i))return i;if(s.includes(rs.extname(e)))return;const r=s.find((t=>ns.existsSync(`${i}${t}`)));return r?`${i}${r}`:void 0}this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let n,o=t._executableFile||`${this._name}-${t._name}`,h=this._executableDir||"";if(this._scriptPath){let t;try{t=ns.realpathSync(this._scriptPath)}catch(e){t=this._scriptPath}h=rs.resolve(rs.dirname(t),h)}if(h){let e=r(h,o);if(!e&&!t._executableFile&&this._scriptPath){const i=rs.basename(this._scriptPath,rs.extname(this._scriptPath));i!==this._name&&(e=r(h,`${i}-${t._name}`))}o=e||o}if(i=s.includes(rs.extname(o)),"win32"!==os.platform?i?(e.unshift(o),e=gs(os.execArgv).concat(e),n=ss.spawn(os.argv[0],e,{stdio:"inherit"})):n=ss.spawn(o,e,{stdio:"inherit"}):(e.unshift(o),e=gs(os.execArgv).concat(e),n=ss.spawn(os.execPath,e,{stdio:"inherit"})),!n.killed){["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach((t=>{os.on(t,(()=>{!1===n.killed&&null===n.exitCode&&n.kill(t)}))}))}const a=this._exitCallback;a?n.on("close",(()=>{a(new ls(os.exitCode||0,"commander.executeSubCommandAsync","(close)"))})):n.on("close",os.exit.bind(os)),n.on("error",(e=>{if("ENOENT"===e.code){const e=h?`searched for local subcommand relative to directory '${h}'`:"no directory for search for local subcommand, use .executableDir() to supply a custom directory",i=`'${o}' does not exist\n - if '${t._name}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead\n - if the default executable name is not suitable, use the executableFile option to supply a custom name or path\n - ${e}`;throw new Error(i)}if("EACCES"===e.code)throw new Error(`'${o}' not executable`);if(a){const t=new ls(1,"commander.executeSubCommandAsync","(error)");t.nestedError=e,a(t)}else os.exit(1)})),this.runningCommand=n}_dispatchSubcommand(t,e,i){const s=this._findCommand(t);let r;return s||this.help({error:!0}),r=this._chainOrCallSubCommandHook(r,s,"preSubcommand"),r=this._chainOrCall(r,(()=>{if(!s._executableHandler)return s._parseCommand(e,i);this._executeSubCommand(s,e.concat(i))})),r}_dispatchHelpCommand(t){t||this.help();const e=this._findCommand(t);return e&&!e._executableHandler&&e.help(),this._dispatchSubcommand(t,[],[this._helpLongFlag])}_checkNumberOfArguments(){this._args.forEach(((t,e)=>{t.required&&null==this.args[e]&&this.missingArgument(t.name())})),this._args.length>0&&this._args[this._args.length-1].variadic||this.args.length>this._args.length&&this._excessArguments(this.args)}_processArguments(){const t=(t,e,i)=>{let s=e;if(null!==e&&t.parseArg)try{s=t.parseArg(e,i)}catch(i){if("commander.invalidArgument"===i.code){const s=`error: command-argument value '${e}' is invalid for argument '${t.name()}'. ${i.message}`;this.error(s,{exitCode:i.exitCode,code:i.code})}throw i}return s};this._checkNumberOfArguments();const e=[];this._args.forEach(((i,s)=>{let r=i.defaultValue;i.variadic?s<this.args.length?(r=this.args.slice(s),i.parseArg&&(r=r.reduce(((e,s)=>t(i,s,e)),i.defaultValue))):void 0===r&&(r=[]):s<this.args.length&&(r=this.args[s],i.parseArg&&(r=t(i,r,i.defaultValue))),e[s]=r})),this.processedArgs=e}_chainOrCall(t,e){return t&&t.then&&"function"==typeof t.then?t.then((()=>e())):e()}_chainOrCallHooks(t,e){let i=t;const s=[];return vs(this).reverse().filter((t=>void 0!==t._lifeCycleHooks[e])).forEach((t=>{t._lifeCycleHooks[e].forEach((e=>{s.push({hookedCommand:t,callback:e})}))})),"postAction"===e&&s.reverse(),s.forEach((t=>{i=this._chainOrCall(i,(()=>t.callback(t.hookedCommand,this)))})),i}_chainOrCallSubCommandHook(t,e,i){let s=t;return void 0!==this._lifeCycleHooks[i]&&this._lifeCycleHooks[i].forEach((t=>{s=this._chainOrCall(s,(()=>t(this,e)))})),s}_parseCommand(t,e){const i=this.parseOptions(e);if(this._parseOptionsEnv(),this._parseOptionsImplied(),t=t.concat(i.operands),e=i.unknown,this.args=t.concat(e),t&&this._findCommand(t[0]))return this._dispatchSubcommand(t[0],t.slice(1),e);if(this._hasImplicitHelpCommand()&&t[0]===this._helpCommandName)return this._dispatchHelpCommand(t[1]);if(this._defaultCommandName)return fs(this,e),this._dispatchSubcommand(this._defaultCommandName,t,e);!this.commands.length||0!==this.args.length||this._actionHandler||this._defaultCommandName||this.help({error:!0}),fs(this,i.unknown),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();const s=()=>{i.unknown.length>0&&this.unknownOption(i.unknown[0])},r=`command:${this.name()}`;if(this._actionHandler){let i;return s(),this._processArguments(),i=this._chainOrCallHooks(i,"preAction"),i=this._chainOrCall(i,(()=>this._actionHandler(this.processedArgs))),this.parent&&(i=this._chainOrCall(i,(()=>{this.parent.emit(r,t,e)}))),i=this._chainOrCallHooks(i,"postAction"),i}if(this.parent&&this.parent.listenerCount(r))s(),this._processArguments(),this.parent.emit(r,t,e);else if(t.length){if(this._findCommand("*"))return this._dispatchSubcommand("*",t,e);this.listenerCount("command:*")?this.emit("command:*",t,e):this.commands.length?this.unknownCommand():(s(),this._processArguments())}else this.commands.length?(s(),this.help({error:!0})):(s(),this._processArguments())}_findCommand(t){if(t)return this.commands.find((e=>e._name===t||e._aliases.includes(t)))}_findOption(t){return this.options.find((e=>e.is(t)))}_checkForMissingMandatoryOptions(){for(let t=this;t;t=t.parent)t.options.forEach((e=>{e.mandatory&&void 0===t.getOptionValue(e.attributeName())&&t.missingMandatoryOptionValue(e)}))}_checkForConflictingLocalOptions(){const t=this.options.filter((t=>{const e=t.attributeName();return void 0!==this.getOptionValue(e)&&"default"!==this.getOptionValueSource(e)})),e=t.filter((t=>t.conflictsWith.length>0));e.forEach((e=>{const i=t.find((t=>e.conflictsWith.includes(t.attributeName())));i&&this._conflictingOption(e,i)}))}_checkForConflictingOptions(){for(let t=this;t;t=t.parent)t._checkForConflictingLocalOptions()}parseOptions(t){const e=[],i=[];let s=e;const r=t.slice();function n(t){return t.length>1&&"-"===t[0]}let o=null;for(;r.length;){const t=r.shift();if("--"===t){s===i&&s.push(t),s.push(...r);break}if(!o||n(t)){if(o=null,n(t)){const e=this._findOption(t);if(e){if(e.required){const t=r.shift();void 0===t&&this.optionMissingArgument(e),this.emit(`option:${e.name()}`,t)}else if(e.optional){let t=null;r.length>0&&!n(r[0])&&(t=r.shift()),this.emit(`option:${e.name()}`,t)}else this.emit(`option:${e.name()}`);o=e.variadic?e:null;continue}}if(t.length>2&&"-"===t[0]&&"-"!==t[1]){const e=this._findOption(`-${t[1]}`);if(e){e.required||e.optional&&this._combineFlagAndOptionalValue?this.emit(`option:${e.name()}`,t.slice(2)):(this.emit(`option:${e.name()}`),r.unshift(`-${t.slice(2)}`));continue}}if(/^--[^=]+=/.test(t)){const e=t.indexOf("="),i=this._findOption(t.slice(0,e));if(i&&(i.required||i.optional)){this.emit(`option:${i.name()}`,t.slice(e+1));continue}}if(n(t)&&(s=i),(this._enablePositionalOptions||this._passThroughOptions)&&0===e.length&&0===i.length){if(this._findCommand(t)){e.push(t),r.length>0&&i.push(...r);break}if(t===this._helpCommandName&&this._hasImplicitHelpCommand()){e.push(t),r.length>0&&e.push(...r);break}if(this._defaultCommandName){i.push(t),r.length>0&&i.push(...r);break}}if(this._passThroughOptions){s.push(t),r.length>0&&s.push(...r);break}s.push(t)}else this.emit(`option:${o.name()}`,t)}return{operands:e,unknown:i}}opts(){if(this._storeOptionsAsProperties){const t={},e=this.options.length;for(let i=0;i<e;i++){const e=this.options[i].attributeName();t[e]=e===this._versionOptionName?this._version:this[e]}return t}return this._optionValues}optsWithGlobals(){return vs(this).reduce(((t,e)=>Object.assign(t,e.opts())),{})}error(t,e){this._outputConfiguration.outputError(`${t}\n`,this._outputConfiguration.writeErr),"string"==typeof this._showHelpAfterError?this._outputConfiguration.writeErr(`${this._showHelpAfterError}\n`):this._showHelpAfterError&&(this._outputConfiguration.writeErr("\n"),this.outputHelp({error:!0}));const i=e||{},s=i.exitCode||1,r=i.code||"commander.error";this._exit(s,r,t)}_parseOptionsEnv(){this.options.forEach((t=>{if(t.envVar&&t.envVar in os.env){const e=t.attributeName();(void 0===this.getOptionValue(e)||["default","config","env"].includes(this.getOptionValueSource(e)))&&(t.required||t.optional?this.emit(`optionEnv:${t.name()}`,os.env[t.envVar]):this.emit(`optionEnv:${t.name()}`))}}))}_parseOptionsImplied(){const t=new ps(this.options),e=t=>void 0!==this.getOptionValue(t)&&!["default","implied"].includes(this.getOptionValueSource(t));this.options.filter((i=>void 0!==i.implied&&e(i.attributeName())&&t.valueFromOption(this.getOptionValue(i.attributeName()),i))).forEach((t=>{Object.keys(t.implied).filter((t=>!e(t))).forEach((e=>{this.setOptionValueWithSource(e,t.implied[e],"implied")}))}))}missingArgument(t){const e=`error: missing required argument '${t}'`;this.error(e,{code:"commander.missingArgument"})}optionMissingArgument(t){const e=`error: option '${t.flags}' argument missing`;this.error(e,{code:"commander.optionMissingArgument"})}missingMandatoryOptionValue(t){const e=`error: required option '${t.flags}' not specified`;this.error(e,{code:"commander.missingMandatoryOptionValue"})}_conflictingOption(t,e){const i=t=>{const e=t.attributeName(),i=this.getOptionValue(e),s=this.options.find((t=>t.negate&&e===t.attributeName())),r=this.options.find((t=>!t.negate&&e===t.attributeName()));return s&&(void 0===s.presetArg&&!1===i||void 0!==s.presetArg&&i===s.presetArg)?s:r||t},s=t=>{const e=i(t),s=e.attributeName();return"env"===this.getOptionValueSource(s)?`environment variable '${e.envVar}'`:`option '${e.flags}'`},r=`error: ${s(t)} cannot be used with ${s(e)}`;this.error(r,{code:"commander.conflictingOption"})}unknownOption(t){if(this._allowUnknownOption)return;let e="";if(t.startsWith("--")&&this._showSuggestionAfterError){let i=[],s=this;do{const t=s.createHelp().visibleOptions(s).filter((t=>t.long)).map((t=>t.long));i=i.concat(t),s=s.parent}while(s&&!s._enablePositionalOptions);e=ms(t,i)}const i=`error: unknown option '${t}'${e}`;this.error(i,{code:"commander.unknownOption"})}_excessArguments(t){if(this._allowExcessArguments)return;const e=this._args.length,i=1===e?"":"s",s=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${e} argument${i} but got ${t.length}.`;this.error(s,{code:"commander.excessArguments"})}unknownCommand(){const t=this.args[0];let e="";if(this._showSuggestionAfterError){const i=[];this.createHelp().visibleCommands(this).forEach((t=>{i.push(t.name()),t.alias()&&i.push(t.alias())})),e=ms(t,i)}const i=`error: unknown command '${t}'${e}`;this.error(i,{code:"commander.unknownCommand"})}version(t,e,i){if(void 0===t)return this._version;this._version=t,e=e||"-V, --version",i=i||"output the version number";const s=this.createOption(e,i);return this._versionOptionName=s.attributeName(),this.options.push(s),this.on("option:"+s.name(),(()=>{this._outputConfiguration.writeOut(`${t}\n`),this._exit(0,"commander.version",t)})),this}description(t,e){return void 0===t&&void 0===e?this._description:(this._description=t,e&&(this._argsDescription=e),this)}summary(t){return void 0===t?this._summary:(this._summary=t,this)}alias(t){if(void 0===t)return this._aliases[0];let e=this;if(0!==this.commands.length&&this.commands[this.commands.length-1]._executableHandler&&(e=this.commands[this.commands.length-1]),t===e._name)throw new Error("Command alias can't be the same as its name");return e._aliases.push(t),this}aliases(t){return void 0===t?this._aliases:(t.forEach((t=>this.alias(t))),this)}usage(t){if(void 0===t){if(this._usage)return this._usage;const t=this._args.map((t=>as(t)));return[].concat(this.options.length||this._hasHelpOption?"[options]":[],this.commands.length?"[command]":[],this._args.length?t:[]).join(" ")}return this._usage=t,this}name(t){return void 0===t?this._name:(this._name=t,this)}nameFromFilename(t){return this._name=rs.basename(t,rs.extname(t)),this}executableDir(t){return void 0===t?this._executableDir:(this._executableDir=t,this)}helpInformation(t){const e=this.createHelp();return void 0===e.helpWidth&&(e.helpWidth=t&&t.error?this._outputConfiguration.getErrHelpWidth():this._outputConfiguration.getOutHelpWidth()),e.formatHelp(this,e)}_getHelpContext(t){const e={error:!!(t=t||{}).error};let i;return i=e.error?t=>this._outputConfiguration.writeErr(t):t=>this._outputConfiguration.writeOut(t),e.write=t.write||i,e.command=this,e}outputHelp(t){let e;"function"==typeof t&&(e=t,t=void 0);const i=this._getHelpContext(t);vs(this).reverse().forEach((t=>t.emit("beforeAllHelp",i))),this.emit("beforeHelp",i);let s=this.helpInformation(i);if(e&&(s=e(s),"string"!=typeof s&&!Buffer.isBuffer(s)))throw new Error("outputHelp callback must return a string or a Buffer");i.write(s),this.emit(this._helpLongFlag),this.emit("afterHelp",i),vs(this).forEach((t=>t.emit("afterAllHelp",i)))}helpOption(t,e){if("boolean"==typeof t)return this._hasHelpOption=t,this;this._helpFlags=t||this._helpFlags,this._helpDescription=e||this._helpDescription;const i=ds(this._helpFlags);return this._helpShortFlag=i.shortFlag,this._helpLongFlag=i.longFlag,this}help(t){this.outputHelp(t);let e=os.exitCode||0;0===e&&t&&"function"!=typeof t&&t.error&&(e=1),this._exit(e,"commander.help","(outputHelp)")}addHelpText(t,e){const i=["beforeAll","before","after","afterAll"];if(!i.includes(t))throw new Error(`Unexpected value for position to addHelpText.\nExpecting one of '${i.join("', '")}'`);const s=`${t}Help`;return this.on(s,(t=>{let i;i="function"==typeof e?e({error:t.error,command:t.command}):e,i&&t.write(`${i}\n`)})),this}},function(t,e){const{Argument:i}=Ui,{Command:s}=Ji,{CommanderError:r,InvalidArgumentError:n}=Wi,{Help:o}=zi,{Option:h}=Ki;(e=t.exports=new s).program=e,e.Argument=i,e.Command=s,e.CommanderError=r,e.Help=o,e.InvalidArgumentError=n,e.InvalidOptionArgumentError=n,e.Option=h}(qi,qi.exports);var bs=u(qi.exports);const{program:ys,createCommand:ws,createArgument:_s,createOption:xs,CommanderError:Os,InvalidArgumentError:Ss,InvalidOptionArgumentError:Cs,Command:$s,Argument:As,Option:Ms,Help:ks}=bs;const Es=Array(),Ts=Array(),Ps="https://fastly.jsdelivr.net/gh/wibus-wee/activation-script@gh-pages";function js(t,e=!1){return`\n[MITM]\nhostname = ${e?"%APPEND% ":""}${t.join(", ")}, as.as, *.as.as\n`}function Is(t,e=!1){const i=e?`${Ps}/activator.js`:"activator.js";return`\n[Script]\nactivation-script-dashboard = type=http-request,pattern=^https://as.as/,requires-body=1,max-size=0,script-path=${i}${e?",script-update-internal=86400":""}\n${t.map((t=>`${t.name} = type=${t.type},pattern=^${t.pattern},requires-body=1,max-size=0,debug=1,script-path=${i}${e?",script-update-internal=86400":""}\n`)).join("")}\n`}function Ds(t,e){var i;console.log(`[I] Generating config for ${t}... Base: ${e}`);const s=new URL(e).hostname,r=(null===(i=s.match(/(?:https?:\/\/)?(?:www\.)?([^\/]+)\/?.*/))||void 0===i?void 0:i[1])||s;Es.includes(`${r}`)||Es.push(`${r}`);const n=Array.isArray(Yi[t].base)?`-${s}`:"";for(const i in Yi[t])if("base"!==i)if("customs"!==i)"object"==typeof Yi[t][i]?Ts.push({name:`${t}-${i}${n}`,pattern:`${e}/${Yi[t][i].base}`,type:Yi[t][i].type||"http-request"}):Ts.push({name:`${t}-${i}${n}`,pattern:`${e}/${i}`,type:"http-request"});else for(const s of Yi[t][i])Ts.push({name:`${t}-${s.base}${n}`,pattern:`${e}/${s.base}`,type:s.type||"http-request"})}function Hs(t=!1){for(const t in Yi){Array.isArray(Yi[t].base)||(Yi[t].base=[Yi[t].base]);for(const e of Yi[t].base)Ds(t,e)}t&&(console.log("================ MITM ================"),console.log(js(Es)),console.log("================ Script ================"),console.log(Is(Ts)))}async function Vs(){Hs();let s=t.cwd();await Hi([{type:"select",name:"config",message:"Where is your config file?",choices:[{title:"Current directory",value:"current"},{title:"Surge config directory",value:"surge"},{title:"Custom",value:"custom"}]}]).then((async i=>{"current"===i.config?s=t.cwd():"surge"===i.config?s=e.join(t.env.HOME,"Library/Application Support/Surge/Profiles"):await Hi([{type:"text",name:"config",message:"Please input your config file path"}]).then((t=>{s=t.config})).catch((t=>{console.log(t)}))})).catch((t=>{console.log(t)}));const r=Array();i.readdirSync(s).forEach((t=>{t.endsWith(".conf")&&r.push(t)})),0!==r.length?Hi([{type:"select",name:"config",message:"Which config file do you want to use?",choices:r.map((t=>({title:t,value:t})))}]).then((t=>{let r="";const n=i.readFileSync(e.join(s,t.config),"utf-8");if(!/\[MITM\]/g.test(n))return void console.error("❌ MITM not found. You should config MITM in Surge first.");const o=/hostname = (.*)/g,h=o.exec(n);console.log("[*] OldHostnames",null==h?void 0:h[1]);const a=Array.from(new Set([...((null==h?void 0:h[1])||"").split(", "),...Es,"as.as","*.as.as"]));console.log("[*] NewHostnames",a),r=n.replace(o,`hostname = ${a.join(", ")}`),i.writeFileSync(e.join(s,t.config),r);const l=/\[Script\]([\s\S]*?)\[/g;let u=!1;l.test(n)&&(u=!0);const c=Is(Ts);console.log("[*] NewScriptContent",c),r=r.replace(u?l:/\[Script\]([\s\S]*)/g,`${c}`),i.writeFileSync(e.join(s,t.config),r),console.log("Config file fixed.")})).catch((t=>{console.log(t)})):console.log("No config file found.")}const Fs=new $s;Fs.name("Activator").version("0.0.1"),Fs.command("gen").description("generate config").option("-o, --out <path>","output path").option("-f, --fix","fix config file").option("-m, --module","generate .sgmodule").option("-e, --external","use external source url").action((async function(s,r){if(Hs(0===Object.keys(s).length),s.out&&(console.log("Generating config file..."),i.writeFileSync(e.join(s.out,"activator.conf"),js(Es)+Is(Ts)),console.log("Config file generated.")),s.fix&&await Vs(),s.module){console.log("Generating .sgmodule file...");let r=i.readFileSync(e.join(t.cwd(),"./template.sgmodule"),"utf-8");r+=`\n\n${js(Es,s.external)}\n\n${Is(Ts,s.external)}`,i.writeFileSync(e.join(t.cwd(),"activator.sgmodule"),`${r}`),console.log(".sgmodule file generated.")}})),Fs.command("inject").description("inject activator").action((async function(){const s=e.join(__dirname,"../../..");let r="";if(console.log("[*] Inject function. You are in ",s),await Hi([{type:"select",name:"config",message:"Where is your config file?",choices:[{title:"Current directory",value:"current"},{title:"Surge config directory",value:"surge"},{title:"Custom",value:"custom"}]}]).then((async i=>{"current"===i.config?r=t.cwd():"surge"===i.config?r=e.join(t.env.HOME,"Library/Application Support/Surge/Profiles"):await Hi([{type:"text",name:"config",message:"Please input your config file path"}]).then((t=>{r=t.config})).catch((t=>{console.log(t)}))})).catch((t=>{console.log(t)})),r){if(i.existsSync(e.join(s,"package.json"))){if(console.log("[I] package.json found. You are using generator in source code."),console.log("[I] activator.js building..."),l("pnpm build"),!i.existsSync(e.join(s,"dist","activator.js")))return void console.error("[E] activator.js bundle not found. Build failed.")}else if(!i.existsSync(e.join(s,"dist","activator.js")))return void console.error("[E] activator.js not found. Please download it first.");if(i.existsSync(e.join(r,"activator.js"))){if("n"===(await Hi([{type:"text",name:"answer",message:"activator.js already exists. Overwrite? (y/n)"}])).answer)return void console.log("[I] Cancelled.");i.rmSync(e.join(r,"activator.js"))}console.log("[I] Injecting activator.js... to",r),i.copyFileSync(e.join(s,"activator.js"),e.join(r,"activator.js")),console.log("[I] Injected activator.js.")}})),Fs.command("patch").description("patch config").action(Vs),Fs.parse();
