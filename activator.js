function e(e){return typeof e==`object`?JSON.stringify(e):e}function t(e){if(typeof e!=`string`)return e;try{return JSON.parse(e)}catch{return e}}function n(e){let t=e.split(`?`)[1],n={};if(t){let e=t.split(`&`);for(let t of e){let[e,r]=t.split(`=`);n[e]=decodeURIComponent(r)}}return n}function r(e){if(!e.includes(`?`))return{path:e,params:{}};let[t]=e.split(`?`);return{url:t,params:n(e),raw:e}}const i=[`get`,`put`,`delete`,`head`,`options`,`patch`,`post`],a={};for(let e of i)a[e]=(t,n)=>{$httpClient[e](t,n)};const o={};for(let e of i)o[e]=t=>new Promise((n,r)=>{a[e](t,(e,t,i)=>{e?r(e):n({status:t.status,headers:t.headers,data:i})})});function s(e){let t=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/`,n=``,r=0;for(;r<e.length;){let i=t.indexOf(e[r++]),a=t.indexOf(e[r++]),o=t.indexOf(e[r++]),s=t.indexOf(e[r++]);n+=String.fromCharCode(i<<2|a>>4),o!==-1&&(n+=String.fromCharCode((a&15)<<4|o>>2)),s!==-1&&(n+=String.fromCharCode((o&3)<<6|s))}return n}function c(t){return t.body&&=e(t.body),{response:{...t}}}function l(t){return t.body&&=e(t.body),t.response?.body&&(t.response.body=e(t.response.body)),{...t}}var u=class{constructor(){this.start=Date.now()}startTimer(){this.start=Date.now()}endTimer(){this.end=Date.now()}getDuration(){return this.end?this.end-this.start:Date.now()-this.start}getDurationInSeconds(){return this.getDuration()/1e3}};function d(){console.log($request);let e=$request.url,t=$request.body,r=n(e);Object.keys(r).length===0&&(r=n(`${$request.url}?${t}`));let i={success:!0,uses:1,purchase:{seller_id:`123`,product_id:r.product_permalink,product_name:r.product_permalink,permalink:r.product_permalink,product_permalink:r.product_permalink,email:`wibus@qq.com`,price:100,gumroad_fee:0,currency:`usd`,quantity:1,discover_fee_charged:!1,can_contact:!1,referrer:`none`,order_number:1234,sale_id:`1`,sale_timestamp:`2099-07-16T19:00:00Z`,license_key:r.license_key,refunded:!1,disputed:!1,dispute_won:!1,id:`1234`,created_at:`2023-07-16T19:00:00Z`}};return c({headers:{"Content-Type":`application/json; charset=utf-8`},body:i})}const f={"401934ec-0a54-433c-a299-2a363501d4be":154474,"f3c67e87-8e95-474d-ace6-5bf28b86dd97":121974,"ca3120ca-f2f7-4d8b-89ec-76effe34431b":221204,"beba1aac-8d65-4cb2-9a33-11ea55d1dcc4":384202},p={"64fd88be-79c0-4167-8078-680ddef8cbc5":9273,"beba1aac-8d65-4cb2-9a33-11ea55d1dcc4":42191},m={id:`47596ad9-a811-4ebf-ac8a-03fc7b6d2a17`,name:`Luke Skywalker`,created_at:new Date().toISOString()};function h(e){let t=f[e]||0,n=p[e]||1;return{license_key:{id:1,status:`active`,key:e,activation_limit:1,activation_usage:0,created_at:new Date().toISOString(),expires_at:null},meta:{store_id:n,order_id:2,order_item_id:3,variant_id:t,variant_name:`Default`,product_id:t,product_name:`Lemon Squeezy`,customer_id:1,customer_name:`Luke Skywalker`,customer_email:`luke@skywalker.com`}}}function g(e=$request.body){let n=t(e),i=n?.license_key||n?.licenseKey||r($request.url).params.license_key||r($request.url).params.licenseKey||r($request.url).params.input?.licenseKey;return console.log(`[lemon-squeezy] license_key: ${i}`),i||``}function _(){return c({body:{activated:!0,instance:m,...h(g()),error:null}})}function v(){return c({body:{valid:!0,error:null,instance:m,...h(g())}})}function y(){let e=$request.body;if(!e)return c({headers:{"Content-Type":`application/json; charset=UTF-8`},body:{success:!1,response:{error:`[Surge] Activator: No body found`}}});let t=e.split(`&`),n=``;for(let e of t)e.includes(`product_id`)&&(n=e.split(`=`)[1]);return c({headers:{"Content-Type":`application/json`},body:{success:!0,response:{product_id:n,activation_id:`@wibus-wee`,type:`activate`,expires:1,expiry_date:1999999999999},signature:``}})}function b(){return c({body:{success:!0,response:{type:`personal`,expires:1,expiry_date:1999999999999},signature:``}})}const x=[{base:`test`,func:async()=>{console.log(`Test`);let e=await o.get({url:`https://baidu.com`});return c({body:{status:e.status,headers:e.headers,data:`Test Success!`}})}},{base:``,func:()=>c({status:200,body:`Dashboard`})}];function S(){return c({body:{status:0,receipt:{in_app:[{expires_date_ms:40960188e5,expires_date:`2100-01-01T00:00:00Z`}]}}})}function C(){return c({body:{hash:t($request.body).hash,tier:`1`}})}function w(){return c({body:{result:`success`}})}function T(){return E()}function E(){let e=JSON.parse($response.body),t=Object.keys(e).filter(e=>e.startsWith(`eligible_`)).reduce((e,t)=>(e[t]=!0,e),{});return l({headers:{...$response.headers},body:{...e,name:`☕︎ ${e.name}`,has_active_subscription:!0,has_pro_features:!0,has_better_ai:!0,...t,publishing_bot:!0,can_upgrade_to_pro:!1,admin:!0}})}function D(){let e=$request.body||`{}`,t=JSON.parse(e);return t.organizations=[],t.trial_limits={commands_limit:999,quicklinks_limit:999,snippets_limit:999},c({body:t})}function O(){return c({body:{deactivated:!0,error:null,...h(g())}})}function k(){return c({headers:{status:`200`}})}function A(){let e=t(r($request.url).params.input).licenseKey;return c({body:{id:`47596ad9-a811-4ebf-ac8a-03fc7b6d2a17`,result:{type:`data`,data:{valid:!0,error:null,instance:m,...h(e)}}}})}function j(){return c({body:{result:{type:`data`,data:{activated:!0,instance:m,...h(g())}}}})}function M(){return c({body:{result:{type:`data`,data:{email:`luke@skywalker.com`}}}})}function N(){return c({body:{success:!0,products:[{vendor:`apple`,product:`DuetAirAnnual`,subscriptionId:391961,inTrial:!1,expiresDate:`2099-11-30T16:00:00Z`,purchaseDate:`2024-11-30T16:00:00Z`,cancelled:!1}],hasStripeAccount:!1}})}function P(){let e=t($request.body),n=g(e?.json);return console.log(e),console.log(n),c({body:{result:{type:`data`,data:{json:{token:`eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWNjZXNzIjp0cnVlLCJkYXRhIjp7ImlzQWRtaW4iOnRydWUsInByb3ZpZGVyIjoibGljZW5zZS1rZXkiLCJleHAiOjg2NDAwMDAwMDAwMDAsInZlcnNpb24iOiIzLjAuMCIsImFybTY0IjoiaHR0cHM6Ly9wcmV2aWV3LnNjcmVlbi5zdHVkaW8vIiwiYXJtNjRETUciOiJodHRwczovL3ByZXZpZXcuc2NyZWVuLnN0dWRpby8iLCJ4NjQiOiJodHRwczovL3ByZXZpZXcuc2NyZWVuLnN0dWRpby8iLCJ0eXBlIjoiYXV0aCIsInVzZXJJZCI6Ijg4ODg4ODg4LTg4ODgtODg4OC04ODg4LTg4ODg4ODg4ODg4OCIsImZ1bGxOYW1lIjoiWDFhMEhlIiwiaWF0IjoxNzMzNTg3MjAwLCJhcHBBY3RpdmF0aW9uIjp7InR5cGUiOiJsaWNlbnNlLWtleSIsImxpY2Vuc2VLZXlJZCI6OTk5LCJpbnN0YW5jZUlkIjoiODg4ODg4ODgtODg4OC04ODg4LTg4ODgtODg4ODg4ODg4ODg4In0sIng2NERNRyI6Imh0dHBzOi8vcHJldmlldy5zY3JlZW4uc3R1ZGlvLyIsImVtYWlsIjoiWDFhMEhlQENyYWNrZWQuY29tIiwiY3JlYXRlZEF0IjoiMjAyNC0xMi0wOFQwMDowMDowMFoifX0.vMEDnH8wdg-09j1MlMccNkj7DiFfRQa1f2UWYz74-So`}}}}})}function F(){return c({body:{result:{type:`data`,data:{json:{token:``}}}}})}const I={dashboard:{base:`http://as.as`,customs:x},lemonSqueezy:{base:`https://api.lemonsqueezy.com/v1/licenses`,activate:_,validate:v,customs:[{base:`deactivate`,func:O}]},paddle:{base:[`https://v3.paddleapi.com/3.2/license`,`https://api.getmedis.com/medis`],activate:y,validate:{base:`verify`,func:b}},gumroad:{base:`https://api.gumroad.com/v2/licenses`,validate:{base:`verify`,func:d}},itunes:{base:`https://buy.itunes.apple.com`,customs:[{base:`verifyReceipt`,func:S}]},raycast:{base:`https://backend.raycast.com/api/v1`,activate:{base:`me`,func:T,type:`http-response`},customs:[{base:`me/trial_status`,func:D}]},shottr:{base:[`https://shottr.cc`],validate:{base:`licensing/verify.php`,func:C},customs:[{base:`api/telemetry.php`,func:w}]},kerlig:{base:`https://b.kerlig.local/api/v1`,customs:[{base:`license`,func:k}]},screenStudio:{base:[`https://www.screen.studio/api/trpc`,`https://screen.studio/api/trpc`],customs:[{base:`license.verify`,func:A},{base:`license.activate`,func:j},{base:`license.licenseInfo`,func:M},{base:`auth.authorize.app.licenseKey`,func:P},{base:`auth.authorize.app.deactivate`,func:F}]},[s(`bWVtbw==`)]:{base:[s(`aHR0cDovL21veXVmZWQuY29tOjMwMDIvYXBp`),s(`aHR0cHM6Ly9saWNlbnNlLm1lbW8uYWMvdjE=`)],customs:[{base:`users/cdkey`,func:()=>c({body:{message:``,success:!0,code:200}})},{base:`licenses/validate`,func:v},{base:`licenses/activate`,func:_},{base:`licenses/deactivate`,func:O}]},duet:{base:`https://rdp.duetdisplay.com/v1`,customs:[{base:`users/validateReceipt`,func:N}]}},L=$request.url.split(`?`)[0];function R(e,t,n=!0){if(Array.isArray(t)){for(let r of t)if(R(e,r,n))return!0;return!1}return e=e.replace(/\/$/,``),t.includes(`*`)&&(n=!1),t=t.replace(`*`,``).replace(/\/$/,``),n&&e===t?!0:!!(!n&&e.includes(t))}async function z(){console.log(`[activator] ${L}`);async function e(t){if(Array.isArray(t.base)){for(let n of t.base){n=n.replace(/\/$/,``);let r=await e({...t,base:n});if(r)return r}return!1}return R(L,t.base)||L.replace(/\/$/,``)===t.base.replace(/\/$/,``)?await t.func():!1}async function t(t){if(typeof t==`object`){let n=await e(t);if(n)return n}}for(let e in I){let n=I[e];if(R(L,n.base,!1))for(let e in console.log(`[activator] ${L} is matched`),n){let r=n[e];if(e===`base`)continue;if(typeof r==`object`&&Array.isArray(r)){for(let e of r){let r=typeof n.base==`string`?`${n.base}/${e.base.replace(/^\//,``)}`:n.base.map(t=>`${t}/${e.base.replace(/^\//,``)}`),i=await t({...e,base:r});if(i)return console.log(`[activator] Handle customs: ${e.base}`),i;console.log(`[activator] ${L} is not matched in customs`)}continue}if(typeof r==`object`&&!Array.isArray(r)){let i=await t({...r,base:`${n.base}/${r.base.replace(/^\//,``)}`});if(i)return console.log(`[activator] Handle ${e}: ${r.base}`),i;continue}let i=typeof n.base==`string`?n.base:n.base.find(e=>R(L,e,!1));if(console.log(`[activator] ${L} | ${i} | ${e}`),R(L,`${i}/${e}`)){if(typeof r==`function`)return console.log(`[activator] Handle ${e}`),await r();if(typeof r==`string`)return c({body:r})}}}return console.log(`[activator] ${L} is not matched`),l({})}const B=`dev`,V=``,H=new u;H.startTimer(),console.log(`===== Activator Script Handler =====`),console.log(`===== Author: @wibus-wee | Version: dev | Commit: ${``?.slice(0,7)||`main`} =====`),(async()=>{$done(await z().catch(e=>(console.log(`Error -> ${e}`),c({status:500,body:{msg:`Activation Script Error. Please check the logs for more details.`,error:{message:e.message,stack:e.stack}}}))).finally(()=>{H.endTimer(),console.log(`===== Finished in ${H.getDurationInSeconds()}s =====`)}))})();