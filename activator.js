"use strict";function e(e){return"object"==typeof e?JSON.stringify(e):e}function t(e){if("string"!=typeof e)return e;try{return JSON.parse(e)}catch(t){return e}}function s(e){const t=e.split("?")[1],s={};if(t){const e=t.split("&");for(const t of e){const[e,a]=t.split("=");s[e]=decodeURIComponent(a)}}return s}function a(e){if(!e.includes("?"))return{path:e,params:{}};const[t]=e.split("?");return{url:t,params:s(e),raw:e}}const n=["get","put","delete","head","options","patch","post"],o={};for(const e of n)o[e]=(t,s)=>{$httpClient[e](t,s)};const r={};for(const e of n)r[e]=t=>new Promise(((s,a)=>{o[e](t,((e,t,n)=>{e?a(e):s({status:t.status,headers:t.headers,data:n})}))}));function i(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";let s="",a=0;for(;a<e.length;){const n=t.indexOf(e[a++]),o=t.indexOf(e[a++]),r=t.indexOf(e[a++]),i=t.indexOf(e[a++]);s+=String.fromCharCode(n<<2|o>>4),-1!==r&&(s+=String.fromCharCode((15&o)<<4|r>>2)),-1!==i&&(s+=String.fromCharCode((3&r)<<6|i))}return s}function c(t){return t.body&&(t.body=e(t.body)),{response:{...t}}}function u(t){var s;return t.body&&(t.body=e(t.body)),(null===(s=t.response)||void 0===s?void 0:s.body)&&(t.response.body=e(t.response.body)),{...t}}const l={"401934ec-0a54-433c-a299-2a363501d4be":154474,"f3c67e87-8e95-474d-ace6-5bf28b86dd97":121974,"ca3120ca-f2f7-4d8b-89ec-76effe34431b":221204,"beba1aac-8d65-4cb2-9a33-11ea55d1dcc4":384202},d={"64fd88be-79c0-4167-8078-680ddef8cbc5":9273,"beba1aac-8d65-4cb2-9a33-11ea55d1dcc4":42191},p={id:"47596ad9-a811-4ebf-ac8a-03fc7b6d2a17",name:"Luke Skywalker",created_at:(new Date).toISOString()};function b(e){const t=l[e]||0,s=d[e]||1;return{license_key:{id:1,status:"active",key:e,activation_limit:1,activation_usage:0,created_at:(new Date).toISOString(),expires_at:null},meta:{store_id:s,order_id:2,order_item_id:3,variant_id:t,variant_name:"Default",product_id:t,product_name:"Lemon Squeezy",customer_id:1,customer_name:"Luke Skywalker",customer_email:"luke@skywalker.com"}}}function f(e=$request.body){var s;const n=t(e),o=(null==n?void 0:n.license_key)||(null==n?void 0:n.licenseKey)||a($request.url).params.license_key||a($request.url).params.licenseKey||(null===(s=a($request.url).params.input)||void 0===s?void 0:s.licenseKey);return console.log(`[lemon-squeezy] license_key: ${o}`),o||""}function y(){const e=f();return c({body:{activated:!0,instance:p,...b(e),error:null}})}function m(){const e=f();return c({body:{valid:!0,error:null,instance:p,...b(e)}})}function g(){return $request.headers["x-raycast-unblock"]?(console.log("Raycast Unblock request"),u({headers:{...$request.headers,"x-raycast-unblock":void 0}})):u({url:$request.url.replace("https://backend.raycast.com","http://127.0.0.1:3000"),headers:$request.headers,body:$request.body})}function h(){return c({body:{deactivated:!0,error:null,...b(f())}})}const v={dashboard:{base:"http://as.as",customs:[{base:"test",func:async()=>{console.log("Test");const e=await r.get({url:"https://baidu.com"});return c({body:{status:e.status,headers:e.headers,data:"Test Success!"}})}},{base:"",func:()=>c({status:200,body:"Dashboard"})}]},lemonSqueezy:{base:"https://api.lemonsqueezy.com/v1/licenses",activate:y,validate:m,customs:[{base:"deactivate",func:h}]},paddle:{base:["https://v3.paddleapi.com/3.2/license","https://api.getmedis.com/medis"],activate:function(){const e=$request.body;if(!e)return c({headers:{"Content-Type":"application/json; charset=UTF-8"},body:{success:!1,response:{error:"[Surge] Activator: No body found"}}});const t=e.split("&");let s="";for(const e of t)e.includes("product_id")&&(s=e.split("=")[1]);return c({headers:{"Content-Type":"application/json"},body:{success:!0,response:{product_id:s,activation_id:"@wibus-wee",type:"activate",expires:1,expiry_date:1999999999999},signature:""}})},validate:{base:"verify",func:function(){return c({body:{success:!0,response:{type:"personal",expires:1,expiry_date:1999999999999},signature:""}})}}},gumroad:{base:"https://api.gumroad.com/v2/licenses",validate:{base:"verify",func:function(){console.log($request);const e=$request.url,t=$request.body;let a=s(e);return 0===Object.keys(a).length&&(a=s(`${$request.url}?${t}`)),c({headers:{"Content-Type":"application/json; charset=utf-8"},body:{success:!0,uses:1,purchase:{seller_id:"123",product_id:a.product_permalink,product_name:a.product_permalink,permalink:a.product_permalink,product_permalink:a.product_permalink,email:"wibus@qq.com",price:100,gumroad_fee:0,currency:"usd",quantity:1,discover_fee_charged:!1,can_contact:!1,referrer:"none",order_number:1234,sale_id:"1",sale_timestamp:"2099-07-16T19:00:00Z",license_key:a.license_key,refunded:!1,disputed:!1,dispute_won:!1,id:"1234",created_at:"2023-07-16T19:00:00Z"}}})}}},itunes:{base:"https://buy.itunes.apple.com",customs:[{base:"verifyReceipt",func:function(){return c({body:{status:0,receipt:{in_app:[{expires_date_ms:40960188e5,expires_date:"2100-01-01T00:00:00Z"}]}}})}}]},raycast:{base:"https://backend.raycast.com/api/v1",activate:{base:"me",func:function(){return function(){const e=JSON.parse($response.body);return u({headers:{...$response.headers},body:{...e,has_active_subscription:!0,has_pro_features:!0,has_better_ai:!0,eligible_for_pro_features:!0,eligible_for_ai:!0,eligible_for_gpt4:!0,eligible_for_ai_citations:!0,eligible_for_developer_hub:!0,eligible_for_application_settings:!0,publishing_bot:!0,can_upgrade_to_pro:!1,admin:!0}})}()},type:"http-response"},customs:[{base:"translations",func:async function(){var e;const s=t($request.body),a={text:s.q,source_lang:s.source||"auto",target_lang:s.target},n={jsonrpc:"2.0",method:"LMT_handle_texts",id:1e3*Math.floor(1e5*Math.random()+1e5),params:{texts:[{text:"",requestAlternatives:3}],timestamp:0,splitting:"newlines",lang:{source_lang_user_selected:a.source_lang.toUpperCase(),target_lang:null===(e=a.target_lang)||void 0===e?void 0:e.toUpperCase()}}};n.params.texts=[{text:a.text,requestAlternatives:3}],n.params.timestamp=function(e){const t=(new Date).getTime();return 0!==e?t-t%(e+1)+(e+1):t}((a.text||"").split("i").length-1);let o=JSON.stringify(n);o=[0,3].includes((n.id+5)%29)||(n.id+3)%13==0?o.replace('"method":"','"method" : "'):o.replace('"method":"','"method": "');return c({headers:{"Content-Type":"application/json; charset=utf-8"},body:{data:{translations:[{translatedText:(await r.post({url:"https://www2.deepl.com/jsonrpc",headers:{"Content-Type":"application/json; charset=utf-8"},body:o}).then((e=>{var s,n,o,r,i,c;const u=t(e.data),{result:l}=u;return{code:200,message:"success",data:null===(n=null===(s=null==l?void 0:l.texts)||void 0===s?void 0:s[0])||void 0===n?void 0:n.text,source_lang:(null==a?void 0:a.source_lang)||(null==l?void 0:l.lang)||"auto",target_lang:(null==a?void 0:a.target_lang)||"en",alternatives:null===(c=null===(i=null===(r=null===(o=l.texts)||void 0===o?void 0:o[0])||void 0===r?void 0:r.alternatives)||void 0===i?void 0:i.map)||void 0===c?void 0:c.call(i,(e=>e.text))}})).catch((e=>({code:500,data:null,message:e})))).data||""}]}}})}},{base:"me/trial_status",func:function(){const e=$request.body||"{}",t=JSON.parse(e);return t.organizations=[],t.trial_limits={commands_limit:999,quicklinks_limit:999,snippets_limit:999},c({body:t})}},{base:"me/sync",func:g},{base:"ai/models",func:g},{base:"ai/chat_completions",func:g}]},shottr:{base:["https://shottr.cc"],validate:{base:"licensing/verify.php",func:function(){return c({body:{hash:t($request.body).hash,tier:"1"}})}},customs:[{base:"api/telemetry.php",func:function(){return c({body:{result:"success"}})}}]},kerlig:{base:"https://b.kerlig.local/api/v1",customs:[{base:"license",func:function(){return c({headers:{status:"200"}})}}]},screenStudio:{base:["https://www.screen.studio/api/trpc","https://screen.studio/api/trpc"],customs:[{base:"license.verify",func:function(){const e=t(a($request.url).params.input).licenseKey;return c({body:{id:"47596ad9-a811-4ebf-ac8a-03fc7b6d2a17",result:{type:"data",data:{valid:!0,error:null,instance:p,...b(e)}}}})}},{base:"license.activate",func:function(){const e=f();return c({body:{result:{type:"data",data:{activated:!0,instance:p,...b(e)}}}})}},{base:"license.licenseInfo",func:function(){return c({body:{result:{type:"data",data:{email:"luke@skywalker.com"}}}})}},{base:"auth.authorize.app.licenseKey",func:function(){const e=t($request.body),s=f(null==e?void 0:e.json);return console.log(e),console.log(s),c({body:{result:{type:"data",data:{json:{token:"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWNjZXNzIjp0cnVlLCJkYXRhIjp7ImlzQWRtaW4iOnRydWUsInByb3ZpZGVyIjoibGljZW5zZS1rZXkiLCJleHAiOjg2NDAwMDAwMDAwMDAsInZlcnNpb24iOiIzLjAuMCIsImFybTY0IjoiaHR0cHM6Ly9wcmV2aWV3LnNjcmVlbi5zdHVkaW8vIiwiYXJtNjRETUciOiJodHRwczovL3ByZXZpZXcuc2NyZWVuLnN0dWRpby8iLCJ4NjQiOiJodHRwczovL3ByZXZpZXcuc2NyZWVuLnN0dWRpby8iLCJ0eXBlIjoiYXV0aCIsInVzZXJJZCI6Ijg4ODg4ODg4LTg4ODgtODg4OC04ODg4LTg4ODg4ODg4ODg4OCIsImZ1bGxOYW1lIjoiWDFhMEhlIiwiaWF0IjoxNzMzNTg3MjAwLCJhcHBBY3RpdmF0aW9uIjp7InR5cGUiOiJsaWNlbnNlLWtleSIsImxpY2Vuc2VLZXlJZCI6OTk5LCJpbnN0YW5jZUlkIjoiODg4ODg4ODgtODg4OC04ODg4LTg4ODgtODg4ODg4ODg4ODg4In0sIng2NERNRyI6Imh0dHBzOi8vcHJldmlldy5zY3JlZW4uc3R1ZGlvLyIsImVtYWlsIjoiWDFhMEhlQENyYWNrZWQuY29tIiwiY3JlYXRlZEF0IjoiMjAyNC0xMi0wOFQwMDowMDowMFoifX0.vMEDnH8wdg-09j1MlMccNkj7DiFfRQa1f2UWYz74-So"}}}}})}},{base:"auth.authorize.app.deactivate",func:function(){return c({body:{result:{type:"data",data:{json:{token:""}}}}})}}]},[i("bWVtbw==")]:{base:[i("aHR0cDovL21veXVmZWQuY29tOjMwMDIvYXBp"),i("aHR0cHM6Ly9saWNlbnNlLm1lbW8uYWMvdjE=")],customs:[{base:"users/cdkey",func:()=>c({body:{message:"",success:!0,code:200}})},{base:"licenses/validate",func:m},{base:"licenses/activate",func:y},{base:"licenses/deactivate",func:h}]},duet:{base:"https://rdp.duetdisplay.com/v1",customs:[{base:"users/validateReceipt",func:function(){return c({body:{success:!0,products:[{vendor:"apple",product:"DuetAirAnnual",subscriptionId:391961,inTrial:!1,expiresDate:"2099-11-30T16:00:00Z",purchaseDate:"2024-11-30T16:00:00Z",cancelled:!1}],hasStripeAccount:!1}})}}]}},_=$request.url.split("?")[0];function w(e,t,s=!0){if(Array.isArray(t)){for(const a of t)if(w(e,a,s))return!0;return!1}return e=e.replace(/\/$/,""),t.includes("*")&&(s=!1),t=t.replace("*","").replace(/\/$/,""),!(!s||e!==t)||!(s||!e.includes(t))}async function $(){async function e(t){if(Array.isArray(t.base)){for(let s of t.base){s=s.replace(/\/$/,"");const a=await e({...t,base:s});if(a)return a}return!1}return(w(_,t.base)||_.replace(/\/$/,"")===t.base.replace(/\/$/,""))&&await t.func()}async function t(t){if("object"==typeof t){const s=await e(t);if(s)return s}}console.log(`[activator] ${_}`);for(const e in v){const s=v[e];if(w(_,s.base,!1)){console.log(`[activator] ${_} is matched`);for(const e in s){const a=s[e];if("base"===e)continue;if("object"==typeof a&&Array.isArray(a)){for(const e of a){const a="string"==typeof s.base?`${s.base}/${e.base.replace(/^\//,"")}`:s.base.map((t=>`${t}/${e.base.replace(/^\//,"")}`)),n=await t({...e,base:a});if(n)return console.log(`[activator] Handle customs: ${e.base}`),n;console.log(`[activator] ${_} is not matched in customs`)}continue}if("object"==typeof a&&!Array.isArray(a)){const n=await t({...a,base:`${s.base}/${a.base.replace(/^\//,"")}`});if(n)return console.log(`[activator] Handle ${e}: ${a.base}`),n;continue}const n="string"==typeof s.base?s.base:s.base.find((e=>w(_,e,!1)));if(console.log(`[activator] ${_} | ${n} | ${e}`),w(_,`${n}/${e}`)){if("function"==typeof a)return console.log(`[activator] Handle ${e}`),await a();if("string"==typeof a)return c({body:a})}}}}return console.log(`[activator] ${_} is not matched`),u({})}const k=new class{constructor(){this.start=Date.now()}startTimer(){this.start=Date.now()}endTimer(){this.end=Date.now()}getDuration(){return this.end?this.end-this.start:Date.now()-this.start}getDurationInSeconds(){return this.getDuration()/1e3}};k.startTimer(),console.log("===== Activator Script Handler ====="),console.log(`===== Author: @wibus-wee | Version: 1.3.0 | Commit: ${"1232786bacedc7a818ee7e9e073c7c97a6c228d8".slice(0,7)||"main"} =====`),(async()=>{$done(await $().catch((e=>(console.log(`Error -> ${e}`),c({status:500,body:{msg:"Activation Script Error. Please check the logs for more details.",error:{message:e.message,stack:e.stack}}})))).finally((()=>{k.endTimer(),console.log(`===== Finished in ${k.getDurationInSeconds()}s =====`)})))})();
